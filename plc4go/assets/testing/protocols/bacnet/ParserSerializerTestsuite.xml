<?xml version='1.0' encoding='utf-8'?>
<!-- 
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing,
  software distributed under the License is distributed on an
  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, either express or implied.  See the License for the
  specific language governing permissions and limitations
  under the License.
 -->
<test:testsuite xmlns:test='https://plc4x.apache.org/schemas/parser-serializer-testsuite.xsd' byteOrder='BIG_ENDIAN'>
  <name>BACnet/IP</name>

  <protocolName>bacnetip</protocolName>
  <outputFlavor>read-write</outputFlavor>

  <testcase>
    <name>1	Simple-ACK      acknowledgeAlarm[  2] </name>
    <!-- TODO: original pcap contains bytes at the end which will be just ignored so we remove them here. A reserved part is 12 instead of 0-->
    <!--raw>810a000b10072c0200003d</raw-->
    <raw>810a00091007200200</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">9</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">16</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="LIFE_SAVETY_MESSAGE">3</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">2</apduType>
                  <APDUSimpleAck>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">2</originalInvokeId>
                    <serviceChoice dataType="uint" bitLength="8">0</serviceChoice>
                  </APDUSimpleAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>2	Unconfirmed-REQ who-Has </name>
    <raw>810a00160120ffff00ff10073d080053594e45524759</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">22</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetUnconfirmedServiceRequestWhoHas>
                          <objectName>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">8</extLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagOctetString>
                                <payload>
                                  <BACnetTagPayloadOctetString>
                                    <value dataType="string" bitLength="64" encoding="ASCII">SYNERGY</value>
                                  </BACnetTagPayloadOctetString>
                                </payload>
                              </BACnetContextTagOctetString>
                            </BACnetContextTag>
                          </objectName>
                        </BACnetUnconfirmedServiceRequestWhoHas>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>4	Unconfirmed-REQ i-Have device,61 device,61 </name>
    <raw>810a00200108000d013d1001c40200003dc40200003d75080053594e45524759</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">32</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">1</serviceChoice>
                        <BACnetUnconfirmedServiceRequestIHave>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">61</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <objectIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">61</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </objectIdentifier>
                          <objectName>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">7</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">8</extLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagCharacterString>
                                <payload>
                                  <BACnetTagPayloadCharacterString>
                                    <encoding>
                                      <BACnetCharacterEncoding dataType="byte" bitLength="8" stringRepresentation="ISO_10646">0x00</BACnetCharacterEncoding>
                                    </encoding>
                                    <value dataType="string" bitLength="56" encoding="UTF-8">SYNERGY</value>
                                  </BACnetTagPayloadCharacterString>
                                </payload>
                              </BACnetApplicationTagCharacterString>
                            </BACnetApplicationTag>
                          </objectName>
                        </BACnetUnconfirmedServiceRequestIHave>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>5	Unconfirmed-REQ who-Has device,61 </name>
    <raw>810a00110120ffff00ff10072c0200003d</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">17</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetUnconfirmedServiceRequestWhoHas>
                          <objectIdentifier>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">61</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetContextTagObjectIdentifier>
                            </BACnetContextTag>
                          </objectIdentifier>
                        </BACnetUnconfirmedServiceRequestWhoHas>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>7	Unconfirmed-REQ i-Have device,61 device,61 </name>
    <raw>810a00200108000d013d1001c40200003dc40200003d75080053594e45524759</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">32</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">1</serviceChoice>
                        <BACnetUnconfirmedServiceRequestIHave>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">61</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <objectIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">61</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </objectIdentifier>
                          <objectName>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">7</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">8</extLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagCharacterString>
                                <payload>
                                  <BACnetTagPayloadCharacterString>
                                    <encoding>
                                      <BACnetCharacterEncoding dataType="byte" bitLength="8" stringRepresentation="ISO_10646">0x00</BACnetCharacterEncoding>
                                    </encoding>
                                    <value dataType="string" bitLength="56" encoding="UTF-8">SYNERGY</value>
                                  </BACnetTagPayloadCharacterString>
                                </payload>
                              </BACnetApplicationTagCharacterString>
                            </BACnetApplicationTag>
                          </objectName>
                        </BACnetUnconfirmedServiceRequestIHave>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>8	Unconfirmed-REQ timeSynchronization </name>
    <raw>810a00160120ffff00ff1006a46a091706b417093600</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">22</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">6</serviceChoice>
                        <BACnetUnconfirmedServiceRequestTimeSynchronization>
                          <synchronizedDate>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">10</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagDate>
                                <payload>
                                  <BACnetTagPayloadDate>
                                    <yearMinus1900 dataType="uint" bitLength="8">106</yearMinus1900>
                                    <month dataType="uint" bitLength="8">9</month>
                                    <dayOfMonth dataType="uint" bitLength="8">23</dayOfMonth>
                                    <dayOfWeek dataType="uint" bitLength="8">6</dayOfWeek>
                                  </BACnetTagPayloadDate>
                                </payload>
                              </BACnetApplicationTagDate>
                            </BACnetApplicationTag>
                          </synchronizedDate>
                          <synchronizedTime>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">11</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagTime>
                                <payload>
                                  <BACnetTagPayloadTime>
                                    <hour dataType="uint" bitLength="8">23</hour>
                                    <minute dataType="uint" bitLength="8">9</minute>
                                    <second dataType="uint" bitLength="8">54</second>
                                    <fractional dataType="uint" bitLength="8">0</fractional>
                                  </BACnetTagPayloadTime>
                                </payload>
                              </BACnetApplicationTagTime>
                            </BACnetApplicationTag>
                          </synchronizedTime>
                        </BACnetUnconfirmedServiceRequestTimeSynchronization>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>10	Unconfirmed-REQ who-Is 61 61 </name>
    <raw>810a00100120ffff00ff1008093d193d</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">16</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">8</serviceChoice>
                        <BACnetUnconfirmedServiceRequestWhoIs>
                          <deviceInstanceRangeLowLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeLowLimit>
                          <deviceInstanceRangeHighLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeHighLimit>
                        </BACnetUnconfirmedServiceRequestWhoIs>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>13	Unconfirmed-REQ i-Am device,61 </name>
    <raw>810b001c0128ffff00000d013dfe1000c40200003d2201e09100212a</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">11</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">28</bvlcLength>
        <BVLCOriginalBroadcastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">254</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">0</serviceChoice>
                        <BACnetUnconfirmedServiceRequestIAm>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">61</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <maximumApduLengthAcceptedLength>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint16 dataType="uint" bitLength="16">480</valueUint16>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </maximumApduLengthAcceptedLength>
                          <segmentationSupported>
                            <BACnetSegmentation>
                              <rawData>
                                <BACnetApplicationTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetApplicationTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x00</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetApplicationTagEnumerated>
                                </BACnetApplicationTag>
                              </rawData>
                            </BACnetSegmentation>
                          </segmentationSupported>
                          <vendorId>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">42</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </vendorId>
                        </BACnetUnconfirmedServiceRequestIAm>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalBroadcastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>14	Confirmed-REQ   atomicWriteFile[  1] file,0 </name>
    <raw>810a01dc0124000d013dff00030107c4028000000e310065fe01c023212f62696e2f73680a2320556e6974207465737473206275696c646572202f2072756e6e657220666f7220746869732070726f6a6563740a0a726d20746573742e6c6f670a746f75636820746573742e6c6f670a0a6d616b65202d662061626f72742e6d616b20636c65616e0a6d616b65202d662061626f72742e6d616b0a2e2f61626f7274203e3e20746573742e6c6f670a6d616b65202d662061626f72742e6d616b20636c65616e0a0a6d616b65202d6620616464726573732e6d616b20636c65616e0a6d616b65202d6620616464726573732e6d616b0a2e2f61646472657373203e3e20746573742e6c6f670a6d616b65202d6620616464726573732e6d616b20636c65616e0a0a6d616b65202d6620636f762e6d616b20636c65616e0a6d616b65202d6620636f762e6d616b0a2e2f636f76203e3e20746573742e6c6f670a6d616b65202d6620636f762e6d616b20636c65616e0a0a6d616b65202d66206463632e6d616b20636c65616e0a6d616b65202d66206463632e6d616b0a2e2f646363203e3e20746573742e6c6f670a6d616b65202d66206463632e6d616b20636c65616e0a0a6d616b65202d662064656d6f2f6f626a6563742f61690f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">476</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">false</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">1</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetConfirmedServiceRequestAtomicWriteFile>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="FILE">10</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">0</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                 </payload>
                               </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <openingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetOpeningTag>
                              </BACnetOpeningTag>
                            </BACnetContextTag>
                          </openingTag>
                          <fileStartPosition>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt8 dataType="int" bitLength="8">0</valueInt8>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetApplicationTagSignedInteger>
                            </BACnetApplicationTag>
                          </fileStartPosition>
                          <fileData>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">6</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">254</extLength>
                                  <extExtLength dataType="uint" bitLength="16">448</extExtLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagOctetString>
                                <payload>
                                  <BACnetTagPayloadOctetString>
                                    <value dataType="string" bitLength="3584" encoding="ASCII">#!/bin/sh
# Unit tests builder / runner for this project

rm test.log
touch test.log

make -f abort.mak clean
make -f abort.mak
./abort >> test.log
make -f abort.mak clean

make -f address.mak clean
make -f address.mak
./address >> test.log
make -f address.mak clean

make -f cov.mak clean
make -f cov.mak
./cov >> test.log
make -f cov.mak clean

make -f dcc.mak clean
make -f dcc.mak
./dcc >> test.log
make -f dcc.mak clean

make -f demo/object/ai</value>
                                  </BACnetTagPayloadOctetString>
                                </payload>
                              </BACnetApplicationTagOctetString>
                            </BACnetApplicationTag>
                          </fileData>
                          <closingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetClosingTag>
                              </BACnetClosingTag>
                            </BACnetContextTag>
                          </closingTag>
                        </BACnetConfirmedServiceRequestAtomicWriteFile>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>15	Complex-ACK     atomicWriteFile[  1] </name>
    <raw>810a000f0108000d013d3001070900</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">15</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">3</apduType>
                  <APDUComplexAck>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">1</originalInvokeId>
                    <serviceAck>
                      <BACnetServiceAck>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetServiceAckAtomicWriteFile>
                          <fileStartPosition>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt8 dataType="int" bitLength="8">0</valueInt8>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetContextTagSignedInteger>
                            </BACnetContextTag>
                          </fileStartPosition>
                        </BACnetServiceAckAtomicWriteFile>
                      </BACnetServiceAck>
                    </serviceAck>
                    <segment dataType="byte" bitLength="0">0x</segment>
                  </APDUComplexAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>16	Confirmed-REQ   atomicWriteFile[  2] file,0 </name>
    <raw>810a01dd0124000d013dff00030207c4028000000e3201c065fe01c02e6d616b20636c65616e0a6d616b65202d662064656d6f2f6f626a6563742f61692e6d616b0a2e2f616e616c6f675f696e707574203e3e20746573742e6c6f670a6d616b65202d662064656d6f2f6f626a6563742f61692e6d616b20636c65616e0a0a6d616b65202d662064656d6f2f6f626a6563742f616f2e6d616b20636c65616e0a6d616b65202d662064656d6f2f6f626a6563742f616f2e6d616b0a2e2f616e616c6f675f6f7574707574203e3e20746573742e6c6f670a6d616b65202d662064656d6f2f6f626a6563742f616f2e6d616b20636c65616e0a0a6d616b65202d662064656d6f2f6f626a6563742f61762e6d616b20636c65616e0a6d616b65202d662064656d6f2f6f626a6563742f61762e6d616b0a2e2f616e616c6f675f76616c7565203e3e20746573742e6c6f670a6d616b65202d662064656d6f2f6f626a6563742f61762e6d616b20636c65616e0a0a6d616b65202d66206172662e6d616b20636c65616e0a6d616b65202d66206172662e6d616b0a2e2f61746f6d69637265616466696c65203e3e20746573742e6c6f670a6d616b65202d66206172662e6d616b20636c65616e0a0a6d616b65202d66206177662e6d616b200f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">477</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">false</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">2</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetConfirmedServiceRequestAtomicWriteFile>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="FILE">10</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">0</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <openingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetOpeningTag>
                              </BACnetOpeningTag>
                            </BACnetContextTag>
                          </openingTag>
                          <fileStartPosition>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt16 dataType="int" bitLength="16">448</valueInt16>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetApplicationTagSignedInteger>
                            </BACnetApplicationTag>
                          </fileStartPosition>
                          <fileData>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">6</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">254</extLength>
                                  <extExtLength dataType="uint" bitLength="16">448</extExtLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagOctetString>
                                <payload>
                                  <BACnetTagPayloadOctetString>
                                    <value dataType="string" bitLength="3584" encoding="ASCII">.mak clean
make -f demo/object/ai.mak
./analog_input >> test.log
make -f demo/object/ai.mak clean

make -f demo/object/ao.mak clean
make -f demo/object/ao.mak
./analog_output >> test.log
make -f demo/object/ao.mak clean

make -f demo/object/av.mak clean
make -f demo/object/av.mak
./analog_value >> test.log
make -f demo/object/av.mak clean

make -f arf.mak clean
make -f arf.mak
./atomicreadfile >> test.log
make -f arf.mak clean

make -f awf.mak</value>
                                  </BACnetTagPayloadOctetString>
                                </payload>
                              </BACnetApplicationTagOctetString>
                            </BACnetApplicationTag>
                          </fileData>
                          <closingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetClosingTag>
                              </BACnetClosingTag>
                            </BACnetContextTag>
                          </closingTag>
                        </BACnetConfirmedServiceRequestAtomicWriteFile>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>17	Complex-ACK     atomicWriteFile[  2] </name>
    <raw>810a00100108000d013d3002070a01c0</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">16</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">3</apduType>
                  <APDUComplexAck>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">2</originalInvokeId>
                    <serviceAck>
                      <BACnetServiceAck>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetServiceAckAtomicWriteFile>
                          <fileStartPosition>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt16 dataType="int" bitLength="16">448</valueInt16>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetContextTagSignedInteger>
                            </BACnetContextTag>
                          </fileStartPosition>
                        </BACnetServiceAckAtomicWriteFile>
                      </BACnetServiceAck>
                    </serviceAck>
                    <segment dataType="byte" bitLength="0">0x</segment>
                  </APDUComplexAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>18	Confirmed-REQ   atomicWriteFile[  3] file,0 </name>
    <raw>810a01dd0124000d013dff00030307c4028000000e32038065fe01c0636c65616e0a6d616b65202d66206177662e6d616b0a2e2f61746f6d6963777269746566696c65203e3e20746573742e6c6f670a6d616b65202d66206177662e6d616b20636c65616e0a0a6d616b65202d66206261636170702e6d616b20636c65616e0a6d616b65202d66206261636170702e6d616b0a2e2f626163617070203e3e20746573742e6c6f670a6d616b65202d66206261636170702e6d616b20636c65616e0a0a6d616b65202d662062616364636f64652e6d616b20636c65616e0a6d616b65202d662062616364636f64652e6d616b0a2e2f62616364636f6465203e3e20746573742e6c6f670a6d616b65202d662062616364636f64652e6d616b20636c65616e0a0a6d616b65202d66206261636572726f722e6d616b20636c65616e0a6d616b65202d66206261636572726f722e6d616b0a2e2f6261636572726f72203e3e20746573742e6c6f670a6d616b65202d66206261636572726f722e6d616b20636c65616e0a0a6d616b65202d66206261637374722e6d616b20636c65616e0a6d616b65202d66206261637374722e6d616b0a2e2f626163737472203e3e20746573742e6c6f670a6d616b65202d66206261637374722e6d616b200f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">477</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">false</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">3</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetConfirmedServiceRequestAtomicWriteFile>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="FILE">10</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">0</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <openingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetOpeningTag>
                              </BACnetOpeningTag>
                            </BACnetContextTag>
                          </openingTag>
                          <fileStartPosition>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt16 dataType="int" bitLength="16">896</valueInt16>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetApplicationTagSignedInteger>
                            </BACnetApplicationTag>
                          </fileStartPosition>
                          <fileData>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">6</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">254</extLength>
                                  <extExtLength dataType="uint" bitLength="16">448</extExtLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagOctetString>
                                <payload>
                                  <BACnetTagPayloadOctetString>
                                    <value dataType="string" bitLength="3584" encoding="ASCII">clean
make -f awf.mak
./atomicwritefile >> test.log
make -f awf.mak clean

make -f bacapp.mak clean
make -f bacapp.mak
./bacapp >> test.log
make -f bacapp.mak clean

make -f bacdcode.mak clean
make -f bacdcode.mak
./bacdcode >> test.log
make -f bacdcode.mak clean

make -f bacerror.mak clean
make -f bacerror.mak
./bacerror >> test.log
make -f bacerror.mak clean

make -f bacstr.mak clean
make -f bacstr.mak
./bacstr >> test.log
make -f bacstr.mak</value>
                                  </BACnetTagPayloadOctetString>
                                </payload>
                              </BACnetApplicationTagOctetString>
                            </BACnetApplicationTag>
                          </fileData>
                          <closingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetClosingTag>
                              </BACnetClosingTag>
                            </BACnetContextTag>
                          </closingTag>
                        </BACnetConfirmedServiceRequestAtomicWriteFile>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>19	Complex-ACK     atomicWriteFile[  3] </name>
    <raw>810a00100108000d013d3003070a0380</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">16</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">3</apduType>
                  <APDUComplexAck>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">3</originalInvokeId>
                    <serviceAck>
                      <BACnetServiceAck>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetServiceAckAtomicWriteFile>
                          <fileStartPosition>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt16 dataType="int" bitLength="16">896</valueInt16>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetContextTagSignedInteger>
                            </BACnetContextTag>
                          </fileStartPosition>
                        </BACnetServiceAckAtomicWriteFile>
                      </BACnetServiceAck>
                    </serviceAck>
                    <segment dataType="byte" bitLength="0">0x</segment>
                  </APDUComplexAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>20	Confirmed-REQ   atomicWriteFile[  4] file,0 </name>
    <raw>810a01dd0124000d013dff00030407c4028000000e32054065fe01c0636c65616e0a0a6d616b65202d662064656d6f2f6f626a6563742f62692e6d616b20636c65616e0a6d616b65202d662064656d6f2f6f626a6563742f62692e6d616b0a2e2f62696e6172795f696e707574203e3e20746573742e6c6f670a6d616b65202d662064656d6f2f6f626a6563742f62692e6d616b20636c65616e0a0a6d616b65202d662064656d6f2f6f626a6563742f626f2e6d616b20636c65616e0a6d616b65202d662064656d6f2f6f626a6563742f626f2e6d616b0a2e2f62696e6172795f6f7574707574203e3e20746573742e6c6f670a6d616b65202d662064656d6f2f6f626a6563742f626f2e6d616b20636c65616e0a0a6d616b65202d662064656d6f2f6f626a6563742f62762e6d616b20636c65616e0a6d616b65202d662064656d6f2f6f626a6563742f62762e6d616b0a2e2f62696e6172795f76616c7565203e3e20746573742e6c6f670a6d616b65202d662064656d6f2f6f626a6563742f62762e6d616b20636c65616e0a0a6d616b65202d66206372632e6d616b20636c65616e0a6d616b65202d66206372632e6d616b0a2e2f637263203e3e20746573742e6c6f670a6d616b65202d66206372632e6d616b20636c65616e0f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">477</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">false</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">4</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetConfirmedServiceRequestAtomicWriteFile>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="FILE">10</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">0</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <openingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetOpeningTag>
                              </BACnetOpeningTag>
                            </BACnetContextTag>
                          </openingTag>
                          <fileStartPosition>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt16 dataType="int" bitLength="16">1344</valueInt16>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetApplicationTagSignedInteger>
                            </BACnetApplicationTag>
                          </fileStartPosition>
                          <fileData>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">6</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">254</extLength>
                                  <extExtLength dataType="uint" bitLength="16">448</extExtLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagOctetString>
                                <payload>
                                  <BACnetTagPayloadOctetString>
                                    <value dataType="string" bitLength="3584" encoding="ASCII">clean

make -f demo/object/bi.mak clean
make -f demo/object/bi.mak
./binary_input >> test.log
make -f demo/object/bi.mak clean

make -f demo/object/bo.mak clean
make -f demo/object/bo.mak
./binary_output >> test.log
make -f demo/object/bo.mak clean

make -f demo/object/bv.mak clean
make -f demo/object/bv.mak
./binary_value >> test.log
make -f demo/object/bv.mak clean

make -f crc.mak clean
make -f crc.mak
./crc >> test.log
make -f crc.mak clean</value>
                                  </BACnetTagPayloadOctetString>
                                </payload>
                              </BACnetApplicationTagOctetString>
                            </BACnetApplicationTag>
                          </fileData>
                          <closingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetClosingTag>
                              </BACnetClosingTag>
                            </BACnetContextTag>
                          </closingTag>
                        </BACnetConfirmedServiceRequestAtomicWriteFile>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>21	Complex-ACK     atomicWriteFile[  4] </name>
    <raw>810a00100108000d013d3004070a0540</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">16</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">3</apduType>
                  <APDUComplexAck>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">4</originalInvokeId>
                    <serviceAck>
                      <BACnetServiceAck>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetServiceAckAtomicWriteFile>
                          <fileStartPosition>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt16 dataType="int" bitLength="16">1344</valueInt16>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetContextTagSignedInteger>
                            </BACnetContextTag>
                          </fileStartPosition>
                        </BACnetServiceAckAtomicWriteFile>
                      </BACnetServiceAck>
                    </serviceAck>
                    <segment dataType="byte" bitLength="0">0x</segment>
                  </APDUComplexAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>22	Confirmed-REQ   atomicWriteFile[  5] file,0 </name>
    <raw>810a01dd0124000d013dff00030507c4028000000e32070065fe01c00a0a6d616b65202d662064656d6f2f6f626a6563742f6465766963652e6d616b20636c65616e0a6d616b65202d662064656d6f2f6f626a6563742f6465766963652e6d616b0a2e2f646576696365203e3e20746573742e6c6f670a6d616b65202d662064656d6f2f6f626a6563742f6465766963652e6d616b20636c65616e0a0a6d616b65202d662069616d2e6d616b20636c65616e0a6d616b65202d662069616d2e6d616b0a2e2f69616d203e3e20746573742e6c6f670a6d616b65202d662069616d2e6d616b20636c65616e0a0a6d616b65202d662069686176652e6d616b20636c65616e0a6d616b65202d662069686176652e6d616b0a2e2f6968617665203e3e20746573742e6c6f670a6d616b65202d662069686176652e6d616b20636c65616e0a0a6d616b65202d6620696e64746578742e6d616b20636c65616e0a6d616b65202d6620696e64746578742e6d616b0a2e2f696e6474657874203e3e20746573742e6c6f670a6d616b65202d6620696e64746578742e6d616b20636c65616e0a0a6d616b65202d662064656d6f2f6f626a6563742f6c73702e6d616b20636c65616e0a6d616b65202d662064656d6f2f6f626a6563742f6c73702e0f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">477</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">false</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">5</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetConfirmedServiceRequestAtomicWriteFile>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="FILE">10</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">0</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <openingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetOpeningTag>
                              </BACnetOpeningTag>
                            </BACnetContextTag>
                          </openingTag>
                          <fileStartPosition>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt16 dataType="int" bitLength="16">1792</valueInt16>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetApplicationTagSignedInteger>
                            </BACnetApplicationTag>
                          </fileStartPosition>
                          <fileData>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">6</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">254</extLength>
                                  <extExtLength dataType="uint" bitLength="16">448</extExtLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagOctetString>
                                <payload>
                                  <BACnetTagPayloadOctetString>
                                    <value dataType="string" bitLength="3584" encoding="ASCII">make -f demo/object/device.mak clean
make -f demo/object/device.mak
./device >> test.log
make -f demo/object/device.mak clean

make -f iam.mak clean
make -f iam.mak
./iam >> test.log
make -f iam.mak clean

make -f ihave.mak clean
make -f ihave.mak
./ihave >> test.log
make -f ihave.mak clean

make -f indtext.mak clean
make -f indtext.mak
./indtext >> test.log
make -f indtext.mak clean

make -f demo/object/lsp.mak clean
make -f demo/object/lsp.</value>
                                  </BACnetTagPayloadOctetString>
                                </payload>
                              </BACnetApplicationTagOctetString>
                            </BACnetApplicationTag>
                          </fileData>
                          <closingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetClosingTag>
                              </BACnetClosingTag>
                            </BACnetContextTag>
                          </closingTag>
                        </BACnetConfirmedServiceRequestAtomicWriteFile>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>23	Complex-ACK     atomicWriteFile[  5] </name>
    <raw>810a00100108000d013d3005070a0700</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">16</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">3</apduType>
                  <APDUComplexAck>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">5</originalInvokeId>
                    <serviceAck>
                      <BACnetServiceAck>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetServiceAckAtomicWriteFile>
                          <fileStartPosition>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt16 dataType="int" bitLength="16">1792</valueInt16>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetContextTagSignedInteger>
                            </BACnetContextTag>
                          </fileStartPosition>
                        </BACnetServiceAckAtomicWriteFile>
                      </BACnetServiceAck>
                    </serviceAck>
                    <segment dataType="byte" bitLength="0">0x</segment>
                  </APDUComplexAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>24	Confirmed-REQ   atomicWriteFile[  6] file,0 </name>
    <raw>810a01dd0124000d013dff00030607c4028000000e3208c065fe01c06d616b0a2e2f6c7370203e3e20746573742e6c6f670a6d616b65202d662064656d6f2f6f626a6563742f6c73702e6d616b20636c65616e0a0a6d616b65202d662064656d6f2f6f626a6563742f6d736f2e6d616b20636c65616e0a6d616b65202d662064656d6f2f6f626a6563742f6d736f2e6d616b0a2e2f6d756c746973746174655f6f7574707574203e3e20746573742e6c6f670a6d616b65202d662064656d6f2f6f626a6563742f6d736f2e6d616b20636c65616e0a0a6d616b65202d66206d7374702e6d616b20636c65616e0a6d616b65202d66206d7374702e6d616b0a2e2f6d737470203e3e20746573742e6c6f670a6d616b65202d66206d7374702e6d616b20636c65616e0a0a6d616b65202d66206e7064752e6d616b20636c65616e0a6d616b65202d66206e7064752e6d616b0a2e2f6e706475203e3e20746573742e6c6f670a6d616b65202d66206e7064752e6d616b20636c65616e0a0a6d616b65202d662072642e6d616b20636c65616e0a6d616b65202d662072642e6d616b0a2e2f7265696e697469616c697a655f646576696365203e3e20746573742e6c6f670a6d616b65202d662072642e6d616b20636c65616e0a0a6d616b650f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">477</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">false</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">6</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetConfirmedServiceRequestAtomicWriteFile>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="FILE">10</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">0</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <openingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetOpeningTag>
                              </BACnetOpeningTag>
                            </BACnetContextTag>
                          </openingTag>
                          <fileStartPosition>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt16 dataType="int" bitLength="16">2240</valueInt16>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetApplicationTagSignedInteger>
                            </BACnetApplicationTag>
                          </fileStartPosition>
                          <fileData>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">6</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">254</extLength>
                                  <extExtLength dataType="uint" bitLength="16">448</extExtLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagOctetString>
                                <payload>
                                  <BACnetTagPayloadOctetString>
                                    <value dataType="string" bitLength="3584" encoding="ASCII">mak
./lsp >> test.log
make -f demo/object/lsp.mak clean

make -f demo/object/mso.mak clean
make -f demo/object/mso.mak
./multistate_output >> test.log
make -f demo/object/mso.mak clean

make -f mstp.mak clean
make -f mstp.mak
./mstp >> test.log
make -f mstp.mak clean

make -f npdu.mak clean
make -f npdu.mak
./npdu >> test.log
make -f npdu.mak clean

make -f rd.mak clean
make -f rd.mak
./reinitialize_device >> test.log
make -f rd.mak clean

make</value>
                                  </BACnetTagPayloadOctetString>
                                </payload>
                              </BACnetApplicationTagOctetString>
                            </BACnetApplicationTag>
                          </fileData>
                          <closingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetClosingTag>
                              </BACnetClosingTag>
                            </BACnetContextTag>
                          </closingTag>
                        </BACnetConfirmedServiceRequestAtomicWriteFile>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>25	Complex-ACK     atomicWriteFile[  6] </name>
    <raw>810a00100108000d013d3006070a08c0</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">16</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">3</apduType>
                  <APDUComplexAck>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">6</originalInvokeId>
                    <serviceAck>
                      <BACnetServiceAck>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetServiceAckAtomicWriteFile>
                          <fileStartPosition>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt16 dataType="int" bitLength="16">2240</valueInt16>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetContextTagSignedInteger>
                            </BACnetContextTag>
                          </fileStartPosition>
                        </BACnetServiceAckAtomicWriteFile>
                      </BACnetServiceAck>
                    </serviceAck>
                    <segment dataType="byte" bitLength="0">0x</segment>
                  </APDUComplexAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>26	Confirmed-REQ   atomicWriteFile[  7] file,0 </name>
    <raw>810a01dd0124000d013dff00030707c4028000000e320a8065fe01c0202d662072656a6563742e6d616b20636c65616e0a6d616b65202d662072656a6563742e6d616b0a2e2f72656a656374203e3e20746573742e6c6f670a6d616b65202d662072656a6563742e6d616b20636c65616e0a0a6d616b65202d662072696e676275662e6d616b20636c65616e0a6d616b65202d662072696e676275662e6d616b0a2e2f72696e67627566203e3e20746573742e6c6f670a6d616b65202d662072696e676275662e6d616b20636c65616e0a0a6d616b65202d662072702e6d616b20636c65616e0a6d616b65202d662072702e6d616b0a2e2f7265616470726f7065727479203e3e20746573742e6c6f670a6d616b65202d662072702e6d616b20636c65616e0a0a6d616b65202d662072706d2e6d616b20636c65616e0a6d616b65202d662072706d2e6d616b0a2e2f72706d203e3e20746573742e6c6f670a6d616b65202d662072706d2e6d616b20636c65616e0a0a6d616b65202d6620736275662e6d616b20636c65616e0a6d616b65202d6620736275662e6d616b0a2e2f73627566203e3e20746573742e6c6f670a6d616b65202d6620736275662e6d616b20636c65616e0a0a6d616b65202d662074736d2e6d616b20636c650f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">477</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">false</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">7</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetConfirmedServiceRequestAtomicWriteFile>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="FILE">10</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">0</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <openingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetOpeningTag>
                              </BACnetOpeningTag>
                            </BACnetContextTag>
                          </openingTag>
                          <fileStartPosition>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt16 dataType="int" bitLength="16">2688</valueInt16>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetApplicationTagSignedInteger>
                            </BACnetApplicationTag>
                          </fileStartPosition>
                          <fileData>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">6</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">254</extLength>
                                  <extExtLength dataType="uint" bitLength="16">448</extExtLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagOctetString>
                                <payload>
                                  <BACnetTagPayloadOctetString>
                                    <value dataType="string" bitLength="3584" encoding="ASCII">-f reject.mak clean
make -f reject.mak
./reject >> test.log
make -f reject.mak clean

make -f ringbuf.mak clean
make -f ringbuf.mak
./ringbuf >> test.log
make -f ringbuf.mak clean

make -f rp.mak clean
make -f rp.mak
./readproperty >> test.log
make -f rp.mak clean

make -f rpm.mak clean
make -f rpm.mak
./rpm >> test.log
make -f rpm.mak clean

make -f sbuf.mak clean
make -f sbuf.mak
./sbuf >> test.log
make -f sbuf.mak clean

make -f tsm.mak cle</value>
                                  </BACnetTagPayloadOctetString>
                                </payload>
                              </BACnetApplicationTagOctetString>
                            </BACnetApplicationTag>
                          </fileData>
                          <closingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetClosingTag>
                              </BACnetClosingTag>
                            </BACnetContextTag>
                          </closingTag>
                        </BACnetConfirmedServiceRequestAtomicWriteFile>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>27	Complex-ACK     atomicWriteFile[  7] </name>
    <raw>810a00100108000d013d3007070a0a80</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">16</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">3</apduType>
                  <APDUComplexAck>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">7</originalInvokeId>
                    <serviceAck>
                      <BACnetServiceAck>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetServiceAckAtomicWriteFile>
                          <fileStartPosition>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt16 dataType="int" bitLength="16">2688</valueInt16>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetContextTagSignedInteger>
                            </BACnetContextTag>
                          </fileStartPosition>
                        </BACnetServiceAckAtomicWriteFile>
                      </BACnetServiceAck>
                    </serviceAck>
                    <segment dataType="byte" bitLength="0">0x</segment>
                  </APDUComplexAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>28	Confirmed-REQ   atomicWriteFile[  8] file,0 </name>
    <raw>810a01600124000d013dff00030807c4028000000e320c4065fe0143616e0a6d616b65202d662074736d2e6d616b0a2e2f74736d203e3e20746573742e6c6f670a6d616b65202d662074736d2e6d616b20636c65616e0a0a6d616b65202d662077686f69732e6d616b20636c65616e0a6d616b65202d662077686f69732e6d616b0a2e2f77686f6973203e3e20746573742e6c6f670a6d616b65202d662077686f69732e6d616b20636c65616e0a0a6d616b65202d662077686f6861732e6d616b20636c65616e0a6d616b65202d662077686f6861732e6d616b0a2e2f77686f686173203e3e20746573742e6c6f670a6d616b65202d662077686f6861732e6d616b20636c65616e0a0a6d616b65202d662077702e6d616b20636c65616e0a6d616b65202d662077702e6d616b0a2e2f777269746570726f7065727479203e3e20746573742e6c6f670a6d616b65202d662077702e6d616b20636c65616e0a0f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">352</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">false</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">8</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetConfirmedServiceRequestAtomicWriteFile>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="FILE">10</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">0</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <openingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetOpeningTag>
                              </BACnetOpeningTag>
                            </BACnetContextTag>
                          </openingTag>
                          <fileStartPosition>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt16 dataType="int" bitLength="16">3136</valueInt16>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetApplicationTagSignedInteger>
                            </BACnetApplicationTag>
                          </fileStartPosition>
                          <fileData>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">6</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">254</extLength>
                                  <extExtLength dataType="uint" bitLength="16">323</extExtLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagOctetString>
                                <payload>
                                  <BACnetTagPayloadOctetString>
                                    <value dataType="string" bitLength="2584" encoding="ASCII">an
make -f tsm.mak
./tsm >> test.log
make -f tsm.mak clean

make -f whois.mak clean
make -f whois.mak
./whois >> test.log
make -f whois.mak clean

make -f whohas.mak clean
make -f whohas.mak
./whohas >> test.log
make -f whohas.mak clean

make -f wp.mak clean
make -f wp.mak
./writeproperty >> test.log
make -f wp.mak clean</value>
                                  </BACnetTagPayloadOctetString>
                                </payload>
                              </BACnetApplicationTagOctetString>
                            </BACnetApplicationTag>
                          </fileData>
                          <closingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetClosingTag>
                              </BACnetClosingTag>
                            </BACnetContextTag>
                          </closingTag>
                        </BACnetConfirmedServiceRequestAtomicWriteFile>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>29	Complex-ACK     atomicWriteFile[  8] </name>
    <raw>810a00100108000d013d3008070a0c40</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">16</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">3</apduType>
                  <APDUComplexAck>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">8</originalInvokeId>
                    <serviceAck>
                      <BACnetServiceAck>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetServiceAckAtomicWriteFile>
                          <fileStartPosition>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt16 dataType="int" bitLength="16">3136</valueInt16>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetContextTagSignedInteger>
                            </BACnetContextTag>
                          </fileStartPosition>
                        </BACnetServiceAckAtomicWriteFile>
                      </BACnetServiceAck>
                    </serviceAck>
                    <segment dataType="byte" bitLength="0">0x</segment>
                  </APDUComplexAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>30	Unconfirmed-REQ who-Is 61 61 </name>
    <raw>810a00100120ffff00ff1008093d193d</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">16</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">8</serviceChoice>
                        <BACnetUnconfirmedServiceRequestWhoIs>
                          <deviceInstanceRangeLowLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeLowLimit>
                          <deviceInstanceRangeHighLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeHighLimit>
                        </BACnetUnconfirmedServiceRequestWhoIs>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>33	Unconfirmed-REQ i-Am device,61 </name>
    <raw>810b001c0128ffff00000d013dfe1000c40200003d2201e09100212a</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">11</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">28</bvlcLength>
        <BVLCOriginalBroadcastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">254</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">0</serviceChoice>
                        <BACnetUnconfirmedServiceRequestIAm>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">61</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <maximumApduLengthAcceptedLength>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint16 dataType="uint" bitLength="16">480</valueUint16>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </maximumApduLengthAcceptedLength>
                          <segmentationSupported>
                            <BACnetSegmentation>
                              <rawData>
                                <BACnetApplicationTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetApplicationTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x00</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetApplicationTagEnumerated>
                                </BACnetApplicationTag>
                              </rawData>
                            </BACnetSegmentation>
                          </segmentationSupported>
                          <vendorId>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">42</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </vendorId>
                        </BACnetUnconfirmedServiceRequestIAm>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalBroadcastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>34	Confirmed-REQ   reinitializeDevice[  1] </name>
    <raw>810a001d0124000d013dff0003011409001d0a0077697265736861726b</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">29</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">false</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">1</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">20</serviceChoice>
                        <BACnetConfirmedServiceRequestReinitializeDevice>
                          <reinitializedStateOfDevice>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagDeviceState>
                                <state>
                                  <BACnetDeviceState dataType="uint" bitLength="8" stringRepresentation="COLDSTART">0</BACnetDeviceState>
                                </state>
                              </BACnetContextTagDeviceState>
                            </BACnetContextTag>
                          </reinitializedStateOfDevice>
                          <password>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">10</extLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagCharacterString>
                                <payload>
                                  <BACnetTagPayloadCharacterString>
                                    <encoding>
                                      <BACnetCharacterEncoding dataType="byte" bitLength="8" stringRepresentation="ISO_10646">0x00</BACnetCharacterEncoding>
                                    </encoding>
                                    <value dataType="string" bitLength="72" encoding="UTF-8">wireshark</value>
                                  </BACnetTagPayloadCharacterString>
                                </payload>
                              </BACnetContextTagCharacterString>
                            </BACnetContextTag>
                          </password>
                        </BACnetConfirmedServiceRequestReinitializeDevice>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>35	Error           reinitializeDevice[  1] </name>
    <raw>810a00110108000d013d5001149105911a</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">17</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">5</apduType>
                  <APDUError>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">1</originalInvokeId>
                    <error>
                      <BACnetError>
                        <serviceChoice dataType="uint" bitLength="8">20</serviceChoice>
                        <BACnetErrorPasswordFailure>
                        </BACnetErrorPasswordFailure>
                        <errorClass>
                          <BACnetApplicationTag>
                            <header>
                              <BACnetTagHeader>
                                <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                <tagClass>
                                  <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                </tagClass>
                                <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                              </BACnetTagHeader>
                            </header>
                            <BACnetApplicationTagEnumerated>
                              <payload>
                                <BACnetTagPayloadEnumerated>
                                  <data dataType="byte" bitLength="8">0x05</data>
                                </BACnetTagPayloadEnumerated>
                              </payload>
                            </BACnetApplicationTagEnumerated>
                          </BACnetApplicationTag>
                        </errorClass>
                        <errorCode>
                          <BACnetApplicationTag>
                            <header>
                              <BACnetTagHeader>
                                <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                <tagClass>
                                  <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                </tagClass>
                                <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                              </BACnetTagHeader>
                            </header>
                            <BACnetApplicationTagEnumerated>
                              <payload>
                                <BACnetTagPayloadEnumerated>
                                  <data dataType="byte" bitLength="8">0x1a</data>
                                </BACnetTagPayloadEnumerated>
                              </payload>
                            </BACnetApplicationTagEnumerated>
                          </BACnetApplicationTag>
                        </errorCode>
                      </BACnetError>
                    </error>
                  </APDUError>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>36	Unconfirmed-REQ who-Is 61 61 </name>
    <raw>810a00100120ffff00ff1008093d193d</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">16</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">8</serviceChoice>
                        <BACnetUnconfirmedServiceRequestWhoIs>
                          <deviceInstanceRangeLowLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeLowLimit>
                          <deviceInstanceRangeHighLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeHighLimit>
                        </BACnetUnconfirmedServiceRequestWhoIs>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>39	Unconfirmed-REQ i-Am device,61 </name>
    <raw>810b001c0128ffff00000d013dfe1000c40200003d2201e09100212a</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">11</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">28</bvlcLength>
        <BVLCOriginalBroadcastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">254</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">0</serviceChoice>
                        <BACnetUnconfirmedServiceRequestIAm>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">61</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <maximumApduLengthAcceptedLength>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint16 dataType="uint" bitLength="16">480</valueUint16>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </maximumApduLengthAcceptedLength>
                          <segmentationSupported>
                            <BACnetSegmentation>
                              <rawData>
                                <BACnetApplicationTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetApplicationTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x00</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetApplicationTagEnumerated>
                                </BACnetApplicationTag>
                              </rawData>
                            </BACnetSegmentation>
                          </segmentationSupported>
                          <vendorId>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">42</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </vendorId>
                        </BACnetUnconfirmedServiceRequestIAm>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalBroadcastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>40	Confirmed-REQ   readProperty[  1] device,61 priority-array </name>
    <raw>810a00160124000d013dff0003010c0c0200003d1957</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">22</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">false</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">1</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">12</serviceChoice>
                        <BACnetConfirmedServiceRequestReadProperty>
                          <objectIdentifier>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">61</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetContextTagObjectIdentifier>
                            </BACnetContextTag>
                          </objectIdentifier>
                          <propertyIdentifier>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagPropertyIdentifier>
                                <propertyIdentifier dataType="uint" bitLength="8" stringRepresentation="PRIORITY_ARRAY">87</propertyIdentifier>
                              </BACnetContextTagPropertyIdentifier>
                            </BACnetContextTag>
                          </propertyIdentifier>
                        </BACnetConfirmedServiceRequestReadProperty>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>41	Error           readProperty[  1] </name>
    <raw>810a00110108000d013d50010c91029120</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">17</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">5</apduType>
                  <APDUError>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">1</originalInvokeId>
                    <error>
                      <BACnetError>
                        <serviceChoice dataType="uint" bitLength="8">12</serviceChoice>
                        <BACnetErrorReadProperty>
                        </BACnetErrorReadProperty>
                        <errorClass>
                          <BACnetApplicationTag>
                            <header>
                              <BACnetTagHeader>
                                <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                <tagClass>
                                  <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                </tagClass>
                                <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                              </BACnetTagHeader>
                            </header>
                            <BACnetApplicationTagEnumerated>
                              <payload>
                                <BACnetTagPayloadEnumerated>
                                  <data dataType="byte" bitLength="8">0x02</data>
                                </BACnetTagPayloadEnumerated>
                              </payload>
                            </BACnetApplicationTagEnumerated>
                          </BACnetApplicationTag>
                        </errorClass>
                        <errorCode>
                          <BACnetApplicationTag>
                            <header>
                              <BACnetTagHeader>
                                <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                <tagClass>
                                  <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                </tagClass>
                                <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                              </BACnetTagHeader>
                            </header>
                            <BACnetApplicationTagEnumerated>
                              <payload>
                                <BACnetTagPayloadEnumerated>
                                  <data dataType="byte" bitLength="8">0x20</data>
                                </BACnetTagPayloadEnumerated>
                              </payload>
                            </BACnetApplicationTagEnumerated>
                          </BACnetApplicationTag>
                        </errorCode>
                      </BACnetError>
                    </error>
                  </APDUError>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>42	Unconfirmed-REQ who-Is 61 61 </name>
    <raw>810a00100120ffff00ff1008093d193d</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">16</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">8</serviceChoice>
                        <BACnetUnconfirmedServiceRequestWhoIs>
                          <deviceInstanceRangeLowLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeLowLimit>
                          <deviceInstanceRangeHighLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeHighLimit>
                        </BACnetUnconfirmedServiceRequestWhoIs>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>45	Unconfirmed-REQ i-Am device,61 </name>
    <raw>810b001c0128ffff00000d013dfe1000c40200003d2201e09100212a</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">11</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">28</bvlcLength>
        <BVLCOriginalBroadcastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">254</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">0</serviceChoice>
                        <BACnetUnconfirmedServiceRequestIAm>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">61</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <maximumApduLengthAcceptedLength>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint16 dataType="uint" bitLength="16">480</valueUint16>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </maximumApduLengthAcceptedLength>
                          <segmentationSupported>
                            <BACnetSegmentation>
                              <rawData>
                                <BACnetApplicationTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetApplicationTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x00</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetApplicationTagEnumerated>
                                </BACnetApplicationTag>
                              </rawData>
                            </BACnetSegmentation>
                          </segmentationSupported>
                          <vendorId>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">42</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </vendorId>
                        </BACnetUnconfirmedServiceRequestIAm>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalBroadcastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>46	Confirmed-REQ   readProperty[  1] analog-input,101 priority-array </name>
    <raw>810a00160124000d013dff0003010c0c000000651957</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">22</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">false</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">1</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">12</serviceChoice>
                        <BACnetConfirmedServiceRequestReadProperty>
                          <objectIdentifier>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="ANALOG_INPUT">0</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">101</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetContextTagObjectIdentifier>
                            </BACnetContextTag>
                          </objectIdentifier>
                          <propertyIdentifier>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagPropertyIdentifier>
                                <propertyIdentifier dataType="uint" bitLength="8" stringRepresentation="PRIORITY_ARRAY">87</propertyIdentifier>
                              </BACnetContextTagPropertyIdentifier>
                            </BACnetContextTag>
                          </propertyIdentifier>
                        </BACnetConfirmedServiceRequestReadProperty>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>47	Error           readProperty[  1] </name>
    <raw>810a00110108000d013d50010c91029120</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">17</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">5</apduType>
                  <APDUError>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">1</originalInvokeId>
                    <error>
                      <BACnetError>
                        <serviceChoice dataType="uint" bitLength="8">12</serviceChoice>
                        <BACnetErrorReadProperty>
                        </BACnetErrorReadProperty>
                        <errorClass>
                          <BACnetApplicationTag>
                            <header>
                              <BACnetTagHeader>
                                <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                <tagClass>
                                  <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                </tagClass>
                                <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                              </BACnetTagHeader>
                            </header>
                            <BACnetApplicationTagEnumerated>
                              <payload>
                                <BACnetTagPayloadEnumerated>
                                  <data dataType="byte" bitLength="8">0x02</data>
                                </BACnetTagPayloadEnumerated>
                              </payload>
                            </BACnetApplicationTagEnumerated>
                          </BACnetApplicationTag>
                        </errorClass>
                        <errorCode>
                          <BACnetApplicationTag>
                            <header>
                              <BACnetTagHeader>
                                <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                <tagClass>
                                  <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                </tagClass>
                                <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                              </BACnetTagHeader>
                            </header>
                            <BACnetApplicationTagEnumerated>
                              <payload>
                                <BACnetTagPayloadEnumerated>
                                  <data dataType="byte" bitLength="8">0x20</data>
                                </BACnetTagPayloadEnumerated>
                              </payload>
                            </BACnetApplicationTagEnumerated>
                          </BACnetApplicationTag>
                        </errorCode>
                      </BACnetError>
                    </error>
                  </APDUError>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>48	Unconfirmed-REQ who-Is 61 61 </name>
    <raw>810a00100120ffff00ff1008093d193d</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">16</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">8</serviceChoice>
                        <BACnetUnconfirmedServiceRequestWhoIs>
                          <deviceInstanceRangeLowLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeLowLimit>
                          <deviceInstanceRangeHighLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeHighLimit>
                        </BACnetUnconfirmedServiceRequestWhoIs>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>51	Unconfirmed-REQ i-Am device,61 </name>
    <raw>810b001c0128ffff00000d013dfe1000c40200003d2201e09100212a</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">11</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">28</bvlcLength>
        <BVLCOriginalBroadcastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">254</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">0</serviceChoice>
                        <BACnetUnconfirmedServiceRequestIAm>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">61</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <maximumApduLengthAcceptedLength>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint16 dataType="uint" bitLength="16">480</valueUint16>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </maximumApduLengthAcceptedLength>
                          <segmentationSupported>
                            <BACnetSegmentation>
                              <rawData>
                                <BACnetApplicationTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetApplicationTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x00</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetApplicationTagEnumerated>
                                </BACnetApplicationTag>
                              </rawData>
                            </BACnetSegmentation>
                          </segmentationSupported>
                          <vendorId>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">42</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </vendorId>
                        </BACnetUnconfirmedServiceRequestIAm>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalBroadcastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>52	Confirmed-REQ   readProperty[  1] analog-output,101 priority-array </name>
    <raw>810a00160124000d013dff0003010c0c004000651957</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">22</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">false</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">1</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">12</serviceChoice>
                        <BACnetConfirmedServiceRequestReadProperty>
                          <objectIdentifier>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="ANALOG_OUTPUT">1</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">101</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetContextTagObjectIdentifier>
                            </BACnetContextTag>
                          </objectIdentifier>
                          <propertyIdentifier>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagPropertyIdentifier>
                                <propertyIdentifier dataType="uint" bitLength="8" stringRepresentation="PRIORITY_ARRAY">87</propertyIdentifier>
                              </BACnetContextTagPropertyIdentifier>
                            </BACnetContextTag>
                          </propertyIdentifier>
                        </BACnetConfirmedServiceRequestReadProperty>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>53	Complex-ACK     readProperty[  1] analog-output,101 priority-array </name>
    <raw>810a00260108000d013d30010c0c0040006519573e000000000000000000000000000000003f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">38</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">3</apduType>
                  <APDUComplexAck>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">1</originalInvokeId>
                    <serviceAck>
                      <BACnetServiceAck>
                        <serviceChoice dataType="uint" bitLength="8">12</serviceChoice>
                        <BACnetServiceAckReadProperty>
                          <objectIdentifier>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="ANALOG_OUTPUT">1</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">101</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetContextTagObjectIdentifier>
                            </BACnetContextTag>
                          </objectIdentifier>
                          <propertyIdentifier>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagPropertyIdentifier>
                                <propertyIdentifier dataType="uint" bitLength="8" stringRepresentation="PRIORITY_ARRAY">87</propertyIdentifier>
                              </BACnetContextTagPropertyIdentifier>
                            </BACnetContextTag>
                          </propertyIdentifier>
                          <values>
                            <BACnetConstructedData>
                              <openingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetOpeningTag>
                                  </BACnetOpeningTag>
                                </BACnetContextTag>
                              </openingTag>
                              <BACnetConstructedDataUnspecified>
                                <data isList="true">
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                </data>
                              </BACnetConstructedDataUnspecified>
                              <closingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetClosingTag>
                                  </BACnetClosingTag>
                                </BACnetContextTag>
                              </closingTag>
                            </BACnetConstructedData>
                          </values>
                        </BACnetServiceAckReadProperty>
                      </BACnetServiceAck>
                    </serviceAck>
                    <segment dataType="byte" bitLength="0">0x</segment>
                  </APDUComplexAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>54	Unconfirmed-REQ unconfirmedCOVNotification device,2 binary-input,4 present-value </name>
    <raw>810a00250120ffff00ff100209011c020000022c00c0000439054e09552e4442c800002f4f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">37</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">2</serviceChoice>
                        <BACnetUnconfirmedServiceRequestUnconfirmedCOVNotification>
                          <subscriberProcessIdentifier>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">1</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </subscriberProcessIdentifier>
                          <initiatingDeviceIdentifier>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">2</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetContextTagObjectIdentifier>
                            </BACnetContextTag>
                          </initiatingDeviceIdentifier>
                          <monitoredObjectIdentifier>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="BINARY_INPUT">3</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">4</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetContextTagObjectIdentifier>
                            </BACnetContextTag>
                          </monitoredObjectIdentifier>
                          <lifetimeInSeconds>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">5</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </lifetimeInSeconds>
                          <listOfValues>
                            <BACnetPropertyValues>
                              <innerOpeningTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">4</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetOpeningTag>
                                  </BACnetOpeningTag>
                                </BACnetContextTag>
                              </innerOpeningTag>
                              <data isList="true">
                                <BACnetPropertyValue>
                                  <propertyIdentifier>
                                    <BACnetContextTag>
                                      <header>
                                        <BACnetTagHeader>
                                          <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                          <tagClass>
                                            <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                          </tagClass>
                                          <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                        </BACnetTagHeader>
                                      </header>
                                      <BACnetContextTagPropertyIdentifier>
                                        <propertyIdentifier dataType="uint" bitLength="8" stringRepresentation="PRESENT_VALUE">85</propertyIdentifier>
                                      </BACnetContextTagPropertyIdentifier>
                                    </BACnetContextTag>
                                  </propertyIdentifier>
                                  <propertyValue>
                                    <BACnetConstructedDataElement>
                                      <constructedData>
                                        <BACnetConstructedData>
                                          <openingTag>
                                            <BACnetContextTag>
                                              <header>
                                                <BACnetTagHeader>
                                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                                  <tagClass>
                                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                                  </tagClass>
                                                  <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                                </BACnetTagHeader>
                                              </header>
                                              <BACnetOpeningTag>
                                              </BACnetOpeningTag>
                                            </BACnetContextTag>
                                          </openingTag>
                                          <BACnetConstructedDataUnspecified>
                                            <data isList="true">
                                              <BACnetConstructedDataElement>
                                                <applicationTag>
                                                  <BACnetApplicationTag>
                                                    <header>
                                                      <BACnetTagHeader>
                                                        <tagNumber dataType="uint" bitLength="4">4</tagNumber>
                                                        <tagClass>
                                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                                        </tagClass>
                                                        <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                                      </BACnetTagHeader>
                                                    </header>
                                                    <BACnetApplicationTagReal>
                                                      <payload>
                                                        <BACnetTagPayloadReal>
                                                          <value dataType="float" bitLength="32">100.0</value>
                                                        </BACnetTagPayloadReal>
                                                      </payload>
                                                    </BACnetApplicationTagReal>
                                                  </BACnetApplicationTag>
                                                </applicationTag>
                                              </BACnetConstructedDataElement>
                                            </data>
                                          </BACnetConstructedDataUnspecified>
                                          <closingTag>
                                            <BACnetContextTag>
                                              <header>
                                                <BACnetTagHeader>
                                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                                  <tagClass>
                                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                                  </tagClass>
                                                  <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                                </BACnetTagHeader>
                                              </header>
                                              <BACnetClosingTag>
                                              </BACnetClosingTag>
                                            </BACnetContextTag>
                                          </closingTag>
                                        </BACnetConstructedData>
                                      </constructedData>
                                    </BACnetConstructedDataElement>
                                  </propertyValue>
                                </BACnetPropertyValue>
                              </data>
                              <innerClosingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">4</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetClosingTag>
                                  </BACnetClosingTag>
                                </BACnetContextTag>
                              </innerClosingTag>
                            </BACnetPropertyValues>
                          </listOfValues>
                        </BACnetUnconfirmedServiceRequestUnconfirmedCOVNotification>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>56	Unconfirmed-REQ who-Is 61 61 </name>
    <raw>810a00100120ffff00ff1008093d193d</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">16</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">8</serviceChoice>
                        <BACnetUnconfirmedServiceRequestWhoIs>
                          <deviceInstanceRangeLowLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeLowLimit>
                          <deviceInstanceRangeHighLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeHighLimit>
                        </BACnetUnconfirmedServiceRequestWhoIs>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>59	Unconfirmed-REQ i-Am device,61 </name>
    <raw>810b001c0128ffff00000d013dfe1000c40200003d2201e09100212a</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">11</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">28</bvlcLength>
        <BVLCOriginalBroadcastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">254</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">0</serviceChoice>
                        <BACnetUnconfirmedServiceRequestIAm>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">61</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <maximumApduLengthAcceptedLength>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint16 dataType="uint" bitLength="16">480</valueUint16>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </maximumApduLengthAcceptedLength>
                          <segmentationSupported>
                            <BACnetSegmentation>
                              <rawData>
                                <BACnetApplicationTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetApplicationTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x00</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetApplicationTagEnumerated>
                                </BACnetApplicationTag>
                              </rawData>
                            </BACnetSegmentation>
                          </segmentationSupported>
                          <vendorId>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">42</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </vendorId>
                        </BACnetUnconfirmedServiceRequestIAm>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalBroadcastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>60	Confirmed-REQ   writeProperty[  1] analog-output,0 present-value </name>
    <raw>810a00190124000d013dff0003010f0c0040000019553e003f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">25</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">false</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">1</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">15</serviceChoice>
                        <BACnetConfirmedServiceRequestWriteProperty>
                          <objectIdentifier>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="ANALOG_OUTPUT">1</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">0</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetContextTagObjectIdentifier>
                            </BACnetContextTag>
                          </objectIdentifier>
                          <propertyIdentifier>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagPropertyIdentifier>
                                <propertyIdentifier dataType="uint" bitLength="8" stringRepresentation="PRESENT_VALUE">85</propertyIdentifier>
                              </BACnetContextTagPropertyIdentifier>
                            </BACnetContextTag>
                          </propertyIdentifier>
                          <propertyValue>
                            <BACnetConstructedData>
                              <openingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetOpeningTag>
                                  </BACnetOpeningTag>
                                </BACnetContextTag>
                              </openingTag>
                              <BACnetConstructedDataUnspecified>
                                <data isList="true">
                                  <BACnetConstructedDataElement>
                                    <applicationTag>
                                      <BACnetApplicationTag>
                                        <header>
                                          <BACnetTagHeader>
                                            <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                            <tagClass>
                                              <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                            </tagClass>
                                            <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                          </BACnetTagHeader>
                                        </header>
                                        <BACnetApplicationTagNull>
                                        </BACnetApplicationTagNull>
                                      </BACnetApplicationTag>
                                    </applicationTag>
                                  </BACnetConstructedDataElement>
                                </data>
                              </BACnetConstructedDataUnspecified>
                              <closingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetClosingTag>
                                  </BACnetClosingTag>
                                </BACnetContextTag>
                              </closingTag>
                            </BACnetConstructedData>
                          </propertyValue>
                        </BACnetConfirmedServiceRequestWriteProperty>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>61	Error           writeProperty[  1] </name>
    <raw>810a00110108000d013d50010f9101911f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">17</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">5</apduType>
                  <APDUError>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">1</originalInvokeId>
                    <error>
                      <BACnetError>
                        <serviceChoice dataType="uint" bitLength="8">15</serviceChoice>
                        <BACnetErrorWriteProperty>
                        </BACnetErrorWriteProperty>
                        <errorClass>
                          <BACnetApplicationTag>
                            <header>
                              <BACnetTagHeader>
                                <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                <tagClass>
                                  <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                </tagClass>
                                <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                              </BACnetTagHeader>
                            </header>
                            <BACnetApplicationTagEnumerated>
                              <payload>
                                <BACnetTagPayloadEnumerated>
                                  <data dataType="byte" bitLength="8">0x01</data>
                                </BACnetTagPayloadEnumerated>
                              </payload>
                            </BACnetApplicationTagEnumerated>
                          </BACnetApplicationTag>
                        </errorClass>
                        <errorCode>
                          <BACnetApplicationTag>
                            <header>
                              <BACnetTagHeader>
                                <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                <tagClass>
                                  <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                </tagClass>
                                <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                              </BACnetTagHeader>
                            </header>
                            <BACnetApplicationTagEnumerated>
                              <payload>
                                <BACnetTagPayloadEnumerated>
                                  <data dataType="byte" bitLength="8">0x1f</data>
                                </BACnetTagPayloadEnumerated>
                              </payload>
                            </BACnetApplicationTagEnumerated>
                          </BACnetApplicationTag>
                        </errorCode>
                      </BACnetError>
                    </error>
                  </APDUError>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>62	Unconfirmed-REQ who-Is 61 61 </name>
    <raw>810a00100120ffff00ff1008093d193d</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">16</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">8</serviceChoice>
                        <BACnetUnconfirmedServiceRequestWhoIs>
                          <deviceInstanceRangeLowLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeLowLimit>
                          <deviceInstanceRangeHighLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeHighLimit>
                        </BACnetUnconfirmedServiceRequestWhoIs>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>65	Unconfirmed-REQ i-Am device,61 </name>
    <raw>810b001c0128ffff00000d013dfe1000c40200003d2201e09100212a</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">11</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">28</bvlcLength>
        <BVLCOriginalBroadcastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">254</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">0</serviceChoice>
                        <BACnetUnconfirmedServiceRequestIAm>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">61</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <maximumApduLengthAcceptedLength>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint16 dataType="uint" bitLength="16">480</valueUint16>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </maximumApduLengthAcceptedLength>
                          <segmentationSupported>
                            <BACnetSegmentation>
                              <rawData>
                                <BACnetApplicationTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetApplicationTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x00</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetApplicationTagEnumerated>
                                </BACnetApplicationTag>
                              </rawData>
                            </BACnetSegmentation>
                          </segmentationSupported>
                          <vendorId>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">42</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </vendorId>
                        </BACnetUnconfirmedServiceRequestIAm>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalBroadcastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>66	Confirmed-REQ   deviceCommunicationControl[  1] </name>
    <raw>810a001c0124000d013dff0003011119002d090066696c6973746572</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">28</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">false</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">1</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">17</serviceChoice>
                        <BACnetConfirmedServiceRequestDeviceCommunicationControl>
                          <enableDisable>
                            <BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                              <rawData>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetContextTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x00</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetContextTagEnumerated>
                                </BACnetContextTag>
                              </rawData>
                            </BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                          </enableDisable>
                          <password>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">9</extLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagCharacterString>
                                <payload>
                                  <BACnetTagPayloadCharacterString>
                                    <encoding>
                                      <BACnetCharacterEncoding dataType="byte" bitLength="8" stringRepresentation="ISO_10646">0x00</BACnetCharacterEncoding>
                                    </encoding>
                                    <value dataType="string" bitLength="64" encoding="UTF-8">filister</value>
                                  </BACnetTagPayloadCharacterString>
                                </payload>
                              </BACnetContextTagCharacterString>
                            </BACnetContextTag>
                          </password>
                        </BACnetConfirmedServiceRequestDeviceCommunicationControl>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>67	Simple-ACK      deviceCommunicationControl[  1] </name>
    <raw>810a000d0108000d013d200111</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">13</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">2</apduType>
                  <APDUSimpleAck>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">1</originalInvokeId>
                    <serviceChoice dataType="uint" bitLength="8">17</serviceChoice>
                  </APDUSimpleAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>68	Unconfirmed-REQ who-Is 61 61 </name>
    <raw>810a00100120ffff00ff1008093d193d</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">16</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">8</serviceChoice>
                        <BACnetUnconfirmedServiceRequestWhoIs>
                          <deviceInstanceRangeLowLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeLowLimit>
                          <deviceInstanceRangeHighLimit>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">61</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetContextTagUnsignedInteger>
                            </BACnetContextTag>
                          </deviceInstanceRangeHighLimit>
                        </BACnetUnconfirmedServiceRequestWhoIs>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>71	Unconfirmed-REQ i-Am device,61 </name>
    <raw>810b001c0128ffff00000d013dfe1000c40200003d2201e09100212a</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">11</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">28</bvlcLength>
        <BVLCOriginalBroadcastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">254</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">0</serviceChoice>
                        <BACnetUnconfirmedServiceRequestIAm>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">61</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <maximumApduLengthAcceptedLength>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint16 dataType="uint" bitLength="16">480</valueUint16>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </maximumApduLengthAcceptedLength>
                          <segmentationSupported>
                            <BACnetSegmentation>
                              <rawData>
                                <BACnetApplicationTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetApplicationTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x00</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetApplicationTagEnumerated>
                                </BACnetApplicationTag>
                              </rawData>
                            </BACnetSegmentation>
                          </segmentationSupported>
                          <vendorId>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">42</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </vendorId>
                        </BACnetUnconfirmedServiceRequestIAm>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalBroadcastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>72	Confirmed-REQ   deviceCommunicationControl[  1] </name>
    <raw>810a001d0124000d013dff0003011119002d0a0077697265736861726b</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">29</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">false</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">1</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">17</serviceChoice>
                        <BACnetConfirmedServiceRequestDeviceCommunicationControl>
                          <enableDisable>
                            <BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                              <rawData>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetContextTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x00</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetContextTagEnumerated>
                                </BACnetContextTag>
                              </rawData>
                            </BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                          </enableDisable>
                          <password>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">10</extLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagCharacterString>
                                <payload>
                                  <BACnetTagPayloadCharacterString>
                                    <encoding>
                                      <BACnetCharacterEncoding dataType="byte" bitLength="8" stringRepresentation="ISO_10646">0x00</BACnetCharacterEncoding>
                                    </encoding>
                                    <value dataType="string" bitLength="72" encoding="UTF-8">wireshark</value>
                                  </BACnetTagPayloadCharacterString>
                                </payload>
                              </BACnetContextTagCharacterString>
                            </BACnetContextTag>
                          </password>
                        </BACnetConfirmedServiceRequestDeviceCommunicationControl>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>73	Error           deviceCommunicationControl[  1] </name>
    <raw>810a00110108000d013d5001119105911a</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">17</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">5</apduType>
                  <APDUError>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">1</originalInvokeId>
                    <error>
                      <BACnetError>
                        <serviceChoice dataType="uint" bitLength="8">17</serviceChoice>
                        <BACnetErrorDeviceCommunicationProtocol>
                        </BACnetErrorDeviceCommunicationProtocol>
                        <errorClass>
                          <BACnetApplicationTag>
                            <header>
                              <BACnetTagHeader>
                                <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                <tagClass>
                                  <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                </tagClass>
                                <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                              </BACnetTagHeader>
                            </header>
                            <BACnetApplicationTagEnumerated>
                              <payload>
                                <BACnetTagPayloadEnumerated>
                                  <data dataType="byte" bitLength="8">0x05</data>
                                </BACnetTagPayloadEnumerated>
                              </payload>
                            </BACnetApplicationTagEnumerated>
                          </BACnetApplicationTag>
                        </errorClass>
                        <errorCode>
                          <BACnetApplicationTag>
                            <header>
                              <BACnetTagHeader>
                                <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                <tagClass>
                                  <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                </tagClass>
                                <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                              </BACnetTagHeader>
                            </header>
                            <BACnetApplicationTagEnumerated>
                              <payload>
                                <BACnetTagPayloadEnumerated>
                                  <data dataType="byte" bitLength="8">0x1a</data>
                                </BACnetTagPayloadEnumerated>
                              </payload>
                            </BACnetApplicationTagEnumerated>
                          </BACnetApplicationTag>
                        </errorCode>
                      </BACnetError>
                    </error>
                  </APDUError>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>74	Unconfirmed-REQ i-Am device,123 </name>
    <raw>810a00180120ffff00ff1000c40200007b2201e091032100</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">24</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">0</serviceChoice>
                        <BACnetUnconfirmedServiceRequestIAm>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">123</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <maximumApduLengthAcceptedLength>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint16 dataType="uint" bitLength="16">480</valueUint16>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </maximumApduLengthAcceptedLength>
                          <segmentationSupported>
                            <BACnetSegmentation>
                              <rawData>
                                <BACnetApplicationTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetApplicationTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x03</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetApplicationTagEnumerated>
                                </BACnetApplicationTag>
                              </rawData>
                            </BACnetSegmentation>
                          </segmentationSupported>
                          <vendorId>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">0</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </vendorId>
                        </BACnetUnconfirmedServiceRequestIAm>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>76	Confirmed-REQ   deviceCommunicationControl[ 49] </name>
    <raw>810a001c010c000d013d0203311119012d0a0077697265736861726b</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">28</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">true</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">49</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">17</serviceChoice>
                        <BACnetConfirmedServiceRequestDeviceCommunicationControl>
                          <enableDisable>
                            <BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                              <rawData>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetContextTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x01</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetContextTagEnumerated>
                                </BACnetContextTag>
                              </rawData>
                            </BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                          </enableDisable>
                          <password>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">10</extLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagCharacterString>
                                <payload>
                                  <BACnetTagPayloadCharacterString>
                                    <encoding>
                                      <BACnetCharacterEncoding dataType="byte" bitLength="8" stringRepresentation="ISO_10646">0x00</BACnetCharacterEncoding>
                                    </encoding>
                                    <value dataType="string" bitLength="72" encoding="UTF-8">wireshark</value>
                                  </BACnetTagPayloadCharacterString>
                                </payload>
                              </BACnetContextTagCharacterString>
                            </BACnetContextTag>
                          </password>
                        </BACnetConfirmedServiceRequestDeviceCommunicationControl>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>78	Confirmed-REQ   deviceCommunicationControl[ 49] </name>
    <raw>810a001c010c000d013d0203311119012d0a0077697265736861726b</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">28</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">true</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">49</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">17</serviceChoice>
                        <BACnetConfirmedServiceRequestDeviceCommunicationControl>
                          <enableDisable>
                            <BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                              <rawData>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetContextTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x01</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetContextTagEnumerated>
                                </BACnetContextTag>
                              </rawData>
                            </BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                          </enableDisable>
                          <password>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">10</extLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagCharacterString>
                                <payload>
                                  <BACnetTagPayloadCharacterString>
                                    <encoding>
                                      <BACnetCharacterEncoding dataType="byte" bitLength="8" stringRepresentation="ISO_10646">0x00</BACnetCharacterEncoding>
                                    </encoding>
                                    <value dataType="string" bitLength="72" encoding="UTF-8">wireshark</value>
                                  </BACnetTagPayloadCharacterString>
                                </payload>
                              </BACnetContextTagCharacterString>
                            </BACnetContextTag>
                          </password>
                        </BACnetConfirmedServiceRequestDeviceCommunicationControl>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>80	Confirmed-REQ   deviceCommunicationControl[ 49] </name>
    <raw>810a001c010c000d013d0203311119012d0a0077697265736861726b</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">28</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">true</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">49</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">17</serviceChoice>
                        <BACnetConfirmedServiceRequestDeviceCommunicationControl>
                          <enableDisable>
                            <BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                              <rawData>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetContextTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x01</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetContextTagEnumerated>
                                </BACnetContextTag>
                              </rawData>
                            </BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                          </enableDisable>
                          <password>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">10</extLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagCharacterString>
                                <payload>
                                  <BACnetTagPayloadCharacterString>
                                    <encoding>
                                      <BACnetCharacterEncoding dataType="byte" bitLength="8" stringRepresentation="ISO_10646">0x00</BACnetCharacterEncoding>
                                    </encoding>
                                    <value dataType="string" bitLength="72" encoding="UTF-8">wireshark</value>
                                  </BACnetTagPayloadCharacterString>
                                </payload>
                              </BACnetContextTagCharacterString>
                            </BACnetContextTag>
                          </password>
                        </BACnetConfirmedServiceRequestDeviceCommunicationControl>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>82	Confirmed-REQ   deviceCommunicationControl[ 49] </name>
    <raw>810a001c010c000d013d0203311119012d0a0077697265736861726b</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">28</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">true</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">49</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">17</serviceChoice>
                        <BACnetConfirmedServiceRequestDeviceCommunicationControl>
                          <enableDisable>
                            <BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                              <rawData>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetContextTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x01</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetContextTagEnumerated>
                                </BACnetContextTag>
                              </rawData>
                            </BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                          </enableDisable>
                          <password>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">10</extLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagCharacterString>
                                <payload>
                                  <BACnetTagPayloadCharacterString>
                                    <encoding>
                                      <BACnetCharacterEncoding dataType="byte" bitLength="8" stringRepresentation="ISO_10646">0x00</BACnetCharacterEncoding>
                                    </encoding>
                                    <value dataType="string" bitLength="72" encoding="UTF-8">wireshark</value>
                                  </BACnetTagPayloadCharacterString>
                                </payload>
                              </BACnetContextTagCharacterString>
                            </BACnetContextTag>
                          </password>
                        </BACnetConfirmedServiceRequestDeviceCommunicationControl>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>84	Unconfirmed-REQ i-Am device,123 </name>
    <raw>810a00180120ffff00ff1000c40200007b2201e091032100</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">24</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">0</serviceChoice>
                        <BACnetUnconfirmedServiceRequestIAm>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">123</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <maximumApduLengthAcceptedLength>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint16 dataType="uint" bitLength="16">480</valueUint16>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </maximumApduLengthAcceptedLength>
                          <segmentationSupported>
                            <BACnetSegmentation>
                              <rawData>
                                <BACnetApplicationTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetApplicationTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x03</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetApplicationTagEnumerated>
                                </BACnetApplicationTag>
                              </rawData>
                            </BACnetSegmentation>
                          </segmentationSupported>
                          <vendorId>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">0</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </vendorId>
                        </BACnetUnconfirmedServiceRequestIAm>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>86	Confirmed-REQ   deviceCommunicationControl[ 50] </name>
    <raw>810a001c010c000d013d0203321119012d0a0077697265736861726b</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">28</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">true</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">50</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">17</serviceChoice>
                        <BACnetConfirmedServiceRequestDeviceCommunicationControl>
                          <enableDisable>
                            <BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                              <rawData>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetContextTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x01</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetContextTagEnumerated>
                                </BACnetContextTag>
                              </rawData>
                            </BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                          </enableDisable>
                          <password>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">10</extLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagCharacterString>
                                <payload>
                                  <BACnetTagPayloadCharacterString>
                                    <encoding>
                                      <BACnetCharacterEncoding dataType="byte" bitLength="8" stringRepresentation="ISO_10646">0x00</BACnetCharacterEncoding>
                                    </encoding>
                                    <value dataType="string" bitLength="72" encoding="UTF-8">wireshark</value>
                                  </BACnetTagPayloadCharacterString>
                                </payload>
                              </BACnetContextTagCharacterString>
                            </BACnetContextTag>
                          </password>
                        </BACnetConfirmedServiceRequestDeviceCommunicationControl>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>87	Error           deviceCommunicationControl[ 50] </name>
    <raw>810a00120120000d013dff5032119105911a</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">18</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">5</apduType>
                  <APDUError>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">50</originalInvokeId>
                    <error>
                      <BACnetError>
                        <serviceChoice dataType="uint" bitLength="8">17</serviceChoice>
                        <BACnetErrorDeviceCommunicationProtocol>
                        </BACnetErrorDeviceCommunicationProtocol>
                        <errorClass>
                          <BACnetApplicationTag>
                            <header>
                              <BACnetTagHeader>
                                <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                <tagClass>
                                  <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                </tagClass>
                                <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                              </BACnetTagHeader>
                            </header>
                            <BACnetApplicationTagEnumerated>
                              <payload>
                                <BACnetTagPayloadEnumerated>
                                  <data dataType="byte" bitLength="8">0x05</data>
                                </BACnetTagPayloadEnumerated>
                              </payload>
                            </BACnetApplicationTagEnumerated>
                          </BACnetApplicationTag>
                        </errorClass>
                        <errorCode>
                          <BACnetApplicationTag>
                            <header>
                              <BACnetTagHeader>
                                <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                <tagClass>
                                  <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                </tagClass>
                                <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                              </BACnetTagHeader>
                            </header>
                            <BACnetApplicationTagEnumerated>
                              <payload>
                                <BACnetTagPayloadEnumerated>
                                  <data dataType="byte" bitLength="8">0x1a</data>
                                </BACnetTagPayloadEnumerated>
                              </payload>
                            </BACnetApplicationTagEnumerated>
                          </BACnetApplicationTag>
                        </errorCode>
                      </BACnetError>
                    </error>
                  </APDUError>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>88	Confirmed-REQ   deviceCommunicationControl[ 51] </name>
    <raw>810a001b010c000d013d0203331119012d090066696c6973746572</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">27</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">true</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">51</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">17</serviceChoice>
                        <BACnetConfirmedServiceRequestDeviceCommunicationControl>
                          <enableDisable>
                            <BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                              <rawData>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetContextTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x01</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetContextTagEnumerated>
                                </BACnetContextTag>
                              </rawData>
                            </BACnetConfirmedServiceRequestReinitializeDeviceEnableDisable>
                          </enableDisable>
                          <password>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">9</extLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagCharacterString>
                                <payload>
                                  <BACnetTagPayloadCharacterString>
                                    <encoding>
                                      <BACnetCharacterEncoding dataType="byte" bitLength="8" stringRepresentation="ISO_10646">0x00</BACnetCharacterEncoding>
                                    </encoding>
                                    <value dataType="string" bitLength="64" encoding="UTF-8">filister</value>
                                  </BACnetTagPayloadCharacterString>
                                </payload>
                              </BACnetContextTagCharacterString>
                            </BACnetContextTag>
                          </password>
                        </BACnetConfirmedServiceRequestDeviceCommunicationControl>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>89	Simple-ACK      deviceCommunicationControl[ 51] </name>
    <raw>810a000e0120000d013dff203311</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">14</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">2</apduType>
                  <APDUSimpleAck>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">51</originalInvokeId>
                    <serviceChoice dataType="uint" bitLength="8">17</serviceChoice>
                  </APDUSimpleAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>90	Unconfirmed-REQ i-Am device,123 </name>
    <raw>810a00180120ffff00ff1000c40200007b2201e091032100</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">24</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">0</serviceChoice>
                        <BACnetUnconfirmedServiceRequestIAm>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">123</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <maximumApduLengthAcceptedLength>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint16 dataType="uint" bitLength="16">480</valueUint16>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </maximumApduLengthAcceptedLength>
                          <segmentationSupported>
                            <BACnetSegmentation>
                              <rawData>
                                <BACnetApplicationTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetApplicationTagEnumerated>
                                    <payload>
                                      <BACnetTagPayloadEnumerated>
                                        <data dataType="byte" bitLength="8">0x03</data>
                                      </BACnetTagPayloadEnumerated>
                                    </payload>
                                  </BACnetApplicationTagEnumerated>
                                </BACnetApplicationTag>
                              </rawData>
                            </BACnetSegmentation>
                          </segmentationSupported>
                          <vendorId>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagUnsignedInteger>
                                <payload>
                                  <BACnetTagPayloadUnsignedInteger>
                                    <valueUint8 dataType="uint" bitLength="8">0</valueUint8>
                                  </BACnetTagPayloadUnsignedInteger>
                                </payload>
                              </BACnetApplicationTagUnsignedInteger>
                            </BACnetApplicationTag>
                          </vendorId>
                        </BACnetUnconfirmedServiceRequestIAm>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>93	Unconfirmed-REQ timeSynchronization </name>
    <raw>810b001a0128ffff00000d013dfe1006a46a0917ffb417150d00</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">11</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">26</bvlcLength>
        <BVLCOriginalBroadcastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">254</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">6</serviceChoice>
                        <BACnetUnconfirmedServiceRequestTimeSynchronization>
                          <synchronizedDate>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">10</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagDate>
                                <payload>
                                  <BACnetTagPayloadDate>
                                    <yearMinus1900 dataType="uint" bitLength="8">106</yearMinus1900>
                                    <month dataType="uint" bitLength="8">9</month>
                                    <dayOfMonth dataType="uint" bitLength="8">23</dayOfMonth>
                                    <dayOfWeek dataType="uint" bitLength="8">255</dayOfWeek>
                                  </BACnetTagPayloadDate>
                                </payload>
                              </BACnetApplicationTagDate>
                            </BACnetApplicationTag>
                          </synchronizedDate>
                          <synchronizedTime>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">11</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagTime>
                                <payload>
                                  <BACnetTagPayloadTime>
                                    <hour dataType="uint" bitLength="8">23</hour>
                                    <minute dataType="uint" bitLength="8">21</minute>
                                    <second dataType="uint" bitLength="8">13</second>
                                    <fractional dataType="uint" bitLength="8">0</fractional>
                                  </BACnetTagPayloadTime>
                                </payload>
                              </BACnetApplicationTagTime>
                            </BACnetApplicationTag>
                          </synchronizedTime>
                        </BACnetUnconfirmedServiceRequestTimeSynchronization>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalBroadcastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>95	Unconfirmed-REQ who-Has device,123 </name>
    <raw>810b00150128ffff00000d013dfe10072c0200007b</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">11</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">21</bvlcLength>
        <BVLCOriginalBroadcastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">254</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetUnconfirmedServiceRequestWhoHas>
                          <objectIdentifier>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">123</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetContextTagObjectIdentifier>
                            </BACnetContextTag>
                          </objectIdentifier>
                        </BACnetUnconfirmedServiceRequestWhoHas>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalBroadcastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>96	Unconfirmed-REQ i-Have device,123 device,123 </name>
    <raw>810a00250120ffff00ff1001c40200007bc40200007b750d0053696d706c65536572766572</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">37</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">65535</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">0</destinationLength>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">1</apduType>
                  <APDUUnconfirmedRequest>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <serviceRequest>
                      <BACnetUnconfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">1</serviceChoice>
                        <BACnetUnconfirmedServiceRequestIHave>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">123</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <objectIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="DEVICE">8</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">123</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </objectIdentifier>
                          <objectName>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">7</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">13</extLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagCharacterString>
                                <payload>
                                  <BACnetTagPayloadCharacterString>
                                    <encoding>
                                      <BACnetCharacterEncoding dataType="byte" bitLength="8" stringRepresentation="ISO_10646">0x00</BACnetCharacterEncoding>
                                    </encoding>
                                    <value dataType="string" bitLength="96" encoding="UTF-8">SimpleServer</value>
                                  </BACnetTagPayloadCharacterString>
                                </payload>
                              </BACnetApplicationTagCharacterString>
                            </BACnetApplicationTag>
                          </objectName>
                        </BACnetUnconfirmedServiceRequestIHave>
                      </BACnetUnconfirmedServiceRequest>
                    </serviceRequest>
                  </APDUUnconfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>98	Confirmed-REQ   reinitializeDevice[ 52] </name>
    <raw>810a001b010c000d013d0203341409001d090066696c6973746572</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">27</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">true</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">52</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">20</serviceChoice>
                        <BACnetConfirmedServiceRequestReinitializeDevice>
                          <reinitializedStateOfDevice>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagDeviceState>
                                <state>
                                  <BACnetDeviceState dataType="uint" bitLength="8" stringRepresentation="COLDSTART">0</BACnetDeviceState>
                                </state>
                              </BACnetContextTagDeviceState>
                            </BACnetContextTag>
                          </reinitializedStateOfDevice>
                          <password>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">9</extLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagCharacterString>
                                <payload>
                                  <BACnetTagPayloadCharacterString>
                                    <encoding>
                                      <BACnetCharacterEncoding dataType="byte" bitLength="8" stringRepresentation="ISO_10646">0x00</BACnetCharacterEncoding>
                                    </encoding>
                                    <value dataType="string" bitLength="64" encoding="UTF-8">filister</value>
                                  </BACnetTagPayloadCharacterString>
                                </payload>
                              </BACnetContextTagCharacterString>
                            </BACnetContextTag>
                          </password>
                        </BACnetConfirmedServiceRequestReinitializeDevice>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>99	Error           reinitializeDevice[ 52] </name>
    <raw>810a00120120000d013dff5034149105911a</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">18</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">5</apduType>
                  <APDUError>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">52</originalInvokeId>
                    <error>
                      <BACnetError>
                        <serviceChoice dataType="uint" bitLength="8">20</serviceChoice>
                        <BACnetErrorPasswordFailure>
                        </BACnetErrorPasswordFailure>
                        <errorClass>
                          <BACnetApplicationTag>
                            <header>
                              <BACnetTagHeader>
                                <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                <tagClass>
                                  <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                </tagClass>
                                <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                              </BACnetTagHeader>
                            </header>
                            <BACnetApplicationTagEnumerated>
                              <payload>
                                <BACnetTagPayloadEnumerated>
                                  <data dataType="byte" bitLength="8">0x05</data>
                                </BACnetTagPayloadEnumerated>
                              </payload>
                            </BACnetApplicationTagEnumerated>
                          </BACnetApplicationTag>
                        </errorClass>
                        <errorCode>
                          <BACnetApplicationTag>
                            <header>
                              <BACnetTagHeader>
                                <tagNumber dataType="uint" bitLength="4">9</tagNumber>
                                <tagClass>
                                  <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                </tagClass>
                                <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                              </BACnetTagHeader>
                            </header>
                            <BACnetApplicationTagEnumerated>
                              <payload>
                                <BACnetTagPayloadEnumerated>
                                  <data dataType="byte" bitLength="8">0x1a</data>
                                </BACnetTagPayloadEnumerated>
                              </payload>
                            </BACnetApplicationTagEnumerated>
                          </BACnetApplicationTag>
                        </errorCode>
                      </BACnetError>
                    </error>
                  </APDUError>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>100	Confirmed-REQ   reinitializeDevice[ 53] </name>
    <raw>810a0018010c000d013d0203351409001d06004a65737573</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">24</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">true</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">53</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">20</serviceChoice>
                        <BACnetConfirmedServiceRequestReinitializeDevice>
                          <reinitializedStateOfDevice>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagDeviceState>
                                <state>
                                  <BACnetDeviceState dataType="uint" bitLength="8" stringRepresentation="COLDSTART">0</BACnetDeviceState>
                                </state>
                              </BACnetContextTagDeviceState>
                            </BACnetContextTag>
                          </reinitializedStateOfDevice>
                          <password>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">6</extLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetContextTagCharacterString>
                                <payload>
                                  <BACnetTagPayloadCharacterString>
                                    <encoding>
                                      <BACnetCharacterEncoding dataType="byte" bitLength="8" stringRepresentation="ISO_10646">0x00</BACnetCharacterEncoding>
                                    </encoding>
                                    <value dataType="string" bitLength="40" encoding="UTF-8">Jesus</value>
                                  </BACnetTagPayloadCharacterString>
                                </payload>
                              </BACnetContextTagCharacterString>
                            </BACnetContextTag>
                          </password>
                        </BACnetConfirmedServiceRequestReinitializeDevice>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>101	Simple-ACK      reinitializeDevice[ 53] </name>
    <raw>810a000e0120000d013dff203514</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">14</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">2</apduType>
                  <APDUSimpleAck>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">53</originalInvokeId>
                    <serviceChoice dataType="uint" bitLength="8">20</serviceChoice>
                  </APDUSimpleAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>102	Confirmed-REQ   atomicReadFile[ 54] file,0 </name>
    <raw>810a001a010c000d013d02033606c4028000000e31002201b80f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">26</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">true</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">54</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">6</serviceChoice>
                        <BACnetConfirmedServiceRequestAtomicReadFile>
                          <fileIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="FILE">10</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">0</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </fileIdentifier>
                          <accessMethod>
                            <BACnetConfirmedServiceRequestAtomicReadFileStreamOrRecord>
                              <openingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetOpeningTag>
                                  </BACnetOpeningTag>
                                </BACnetContextTag>
                              </openingTag>
                              <BACnetConfirmedServiceRequestAtomicReadFileStream>
                                <fileStartPosition>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagSignedInteger>
                                      <payload>
                                        <BACnetTagPayloadSignedInteger>
                                          <valueInt8 dataType="int" bitLength="8">0</valueInt8>
                                        </BACnetTagPayloadSignedInteger>
                                      </payload>
                                    </BACnetApplicationTagSignedInteger>
                                  </BACnetApplicationTag>
                                </fileStartPosition>
                                <requestOctetCount>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagUnsignedInteger>
                                      <payload>
                                        <BACnetTagPayloadUnsignedInteger>
                                          <valueUint16 dataType="uint" bitLength="16">440</valueUint16>
                                        </BACnetTagPayloadUnsignedInteger>
                                      </payload>
                                    </BACnetApplicationTagUnsignedInteger>
                                  </BACnetApplicationTag>
                                </requestOctetCount>
                              </BACnetConfirmedServiceRequestAtomicReadFileStream>
                              <closingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetClosingTag>
                                  </BACnetClosingTag>
                                </BACnetContextTag>
                              </closingTag>
                            </BACnetConfirmedServiceRequestAtomicReadFileStreamOrRecord>
                          </accessMethod>
                        </BACnetConfirmedServiceRequestAtomicReadFile>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>103	Complex-ACK     atomicReadFile[ 54] </name>
    <raw>810a01cf0120000d013dff303606100e310065fe01b85465737420224241436e65742041626f7274223a0a095061737365643a203236303130370a094661696c65643a20300a5465737420224241436e65742041646472657373223a0a095061737365643a20323830350a094661696c65643a20300a5465737420224241436e657420446576696365436f6d6d756e69636174696f6e436f6e74726f6c223a0a095061737365643a2031320a094661696c65643a20300a5465737420224241436e657420416e616c6f6720496e707574223a0a095061737365643a20340a094661696c65643a20300a5465737420224241436e657420416e616c6f67204f7574707574223a0a095061737365643a20340a094661696c65643a20300a5465737420224241436e657420416e616c6f672056616c7565223a0a095061737365643a20340a094661696c65643a20300a5465737420224241436e65742041746f6d69635265616446696c65223a0a095061737365643a2032390a094661696c65643a20300a5465737420224241436e65742041746f6d6963577269746546696c65223a0a095061737365643a2032350a094661696c65643a20300a5465737420224241436e6574204170706c696361740f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">463</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">3</apduType>
                  <APDUComplexAck>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">54</originalInvokeId>
                    <serviceAck>
                      <BACnetServiceAck>
                        <serviceChoice dataType="uint" bitLength="8">6</serviceChoice>
                        <BACnetServiceAckAtomicReadFile>
                          <endOfFile>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagBoolean>
                                <payload>
                                  <BACnetTagPayloadBoolean>
                                  </BACnetTagPayloadBoolean>
                                </payload>
                              </BACnetApplicationTagBoolean>
                            </BACnetApplicationTag>
                          </endOfFile>
                          <accessMethod>
                            <BACnetServiceAckAtomicReadFileStreamOrRecord>
                              <openingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetOpeningTag>
                                  </BACnetOpeningTag>
                                </BACnetContextTag>
                              </openingTag>
                              <BACnetServiceAckAtomicReadFileStream>
                                <fileStartPosition>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagSignedInteger>
                                      <payload>
                                        <BACnetTagPayloadSignedInteger>
                                          <valueInt8 dataType="int" bitLength="8">0</valueInt8>
                                        </BACnetTagPayloadSignedInteger>
                                      </payload>
                                    </BACnetApplicationTagSignedInteger>
                                  </BACnetApplicationTag>
                                </fileStartPosition>
                                <fileData>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">6</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                        <extLength dataType="uint" bitLength="8">254</extLength>
                                        <extExtLength dataType="uint" bitLength="16">440</extExtLength>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagOctetString>
                                      <payload>
                                        <BACnetTagPayloadOctetString>
                                          <value dataType="string" bitLength="3520" encoding="ASCII">Test "BACnet Abort":
	Passed: 260107
	Failed: 0
Test "BACnet Address":
	Passed: 2805
	Failed: 0
Test "BACnet DeviceCommunicationControl":
	Passed: 12
	Failed: 0
Test "BACnet Analog Input":
	Passed: 4
	Failed: 0
Test "BACnet Analog Output":
	Passed: 4
	Failed: 0
Test "BACnet Analog Value":
	Passed: 4
	Failed: 0
Test "BACnet AtomicReadFile":
	Passed: 29
	Failed: 0
Test "BACnet AtomicWriteFile":
	Passed: 25
	Failed: 0
Test "BACnet Applicat</value>
                                        </BACnetTagPayloadOctetString>
                                      </payload>
                                    </BACnetApplicationTagOctetString>
                                  </BACnetApplicationTag>
                                </fileData>
                              </BACnetServiceAckAtomicReadFileStream>
                              <closingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetClosingTag>
                                  </BACnetClosingTag>
                                </BACnetContextTag>
                              </closingTag>
                            </BACnetServiceAckAtomicReadFileStreamOrRecord>
                          </accessMethod>
                        </BACnetServiceAckAtomicReadFile>
                      </BACnetServiceAck>
                    </serviceAck>
                    <segment dataType="byte" bitLength="0">0x</segment>
                  </APDUComplexAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>104	Confirmed-REQ   atomicReadFile[ 55] file,0 </name>
    <raw>810a001b010c000d013d02033706c4028000000e3201b82201b80f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">27</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">true</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">55</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">6</serviceChoice>
                        <BACnetConfirmedServiceRequestAtomicReadFile>
                          <fileIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="FILE">10</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">0</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </fileIdentifier>
                          <accessMethod>
                            <BACnetConfirmedServiceRequestAtomicReadFileStreamOrRecord>
                              <openingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetOpeningTag>
                                  </BACnetOpeningTag>
                                </BACnetContextTag>
                              </openingTag>
                              <BACnetConfirmedServiceRequestAtomicReadFileStream>
                                <fileStartPosition>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagSignedInteger>
                                      <payload>
                                        <BACnetTagPayloadSignedInteger>
                                          <valueInt16 dataType="int" bitLength="16">440</valueInt16>
                                        </BACnetTagPayloadSignedInteger>
                                      </payload>
                                    </BACnetApplicationTagSignedInteger>
                                  </BACnetApplicationTag>
                                </fileStartPosition>
                                <requestOctetCount>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagUnsignedInteger>
                                      <payload>
                                        <BACnetTagPayloadUnsignedInteger>
                                          <valueUint16 dataType="uint" bitLength="16">440</valueUint16>
                                        </BACnetTagPayloadUnsignedInteger>
                                      </payload>
                                    </BACnetApplicationTagUnsignedInteger>
                                  </BACnetApplicationTag>
                                </requestOctetCount>
                              </BACnetConfirmedServiceRequestAtomicReadFileStream>
                              <closingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetClosingTag>
                                  </BACnetClosingTag>
                                </BACnetContextTag>
                              </closingTag>
                            </BACnetConfirmedServiceRequestAtomicReadFileStreamOrRecord>
                          </accessMethod>
                        </BACnetConfirmedServiceRequestAtomicReadFile>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>105	Complex-ACK     atomicReadFile[ 55] </name>
    <raw>810a01d00120000d013dff303706100e3201b865fe01b8696f6e2044617461223a0a095061737365643a2036360a094661696c65643a20300a54657374202242414344436f6465223a0a095061737365643a2031323631373533390a094661696c65643a20300a5465737420224241436e6574204572726f72223a0a095061737365643a2036343237350a094661696c65643a20300a5465737420224241436e657420537472696e6773223a0a095061737365643a20313135330a094661696c65643a20300a5465737420224241436e65742042696e61727920496e707574223a0a095061737365643a20340a094661696c65643a20300a5465737420224241436e65742042696e617279204f7574707574223a0a095061737365643a20340a094661696c65643a20300a5465737420224241436e65742042696e6172795f56616c7565223a0a095061737365643a20340a094661696c65643a20300a546573742022637263223a0a095061737365643a2031330a094661696c65643a20300a5465737420224241436e657420446576696365223a0a095061737365643a2031320a094661696c65643a20300a5465737420224241436e657420492d416d223a0a095061737365643a20360a0946610f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">464</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">3</apduType>
                  <APDUComplexAck>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">55</originalInvokeId>
                    <serviceAck>
                      <BACnetServiceAck>
                        <serviceChoice dataType="uint" bitLength="8">6</serviceChoice>
                        <BACnetServiceAckAtomicReadFile>
                          <endOfFile>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagBoolean>
                                <payload>
                                  <BACnetTagPayloadBoolean>
                                  </BACnetTagPayloadBoolean>
                                </payload>
                              </BACnetApplicationTagBoolean>
                            </BACnetApplicationTag>
                          </endOfFile>
                          <accessMethod>
                            <BACnetServiceAckAtomicReadFileStreamOrRecord>
                              <openingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetOpeningTag>
                                  </BACnetOpeningTag>
                                </BACnetContextTag>
                              </openingTag>
                              <BACnetServiceAckAtomicReadFileStream>
                                <fileStartPosition>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagSignedInteger>
                                      <payload>
                                        <BACnetTagPayloadSignedInteger>
                                          <valueInt16 dataType="int" bitLength="16">440</valueInt16>
                                        </BACnetTagPayloadSignedInteger>
                                      </payload>
                                    </BACnetApplicationTagSignedInteger>
                                  </BACnetApplicationTag>
                                </fileStartPosition>
                                <fileData>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">6</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                        <extLength dataType="uint" bitLength="8">254</extLength>
                                        <extExtLength dataType="uint" bitLength="16">440</extExtLength>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagOctetString>
                                      <payload>
                                        <BACnetTagPayloadOctetString>
                                          <value dataType="string" bitLength="3520" encoding="ASCII">ion Data":
	Passed: 66
	Failed: 0
Test "BACDCode":
	Passed: 12617539
	Failed: 0
Test "BACnet Error":
	Passed: 64275
	Failed: 0
Test "BACnet Strings":
	Passed: 1153
	Failed: 0
Test "BACnet Binary Input":
	Passed: 4
	Failed: 0
Test "BACnet Binary Output":
	Passed: 4
	Failed: 0
Test "BACnet Binary_Value":
	Passed: 4
	Failed: 0
Test "crc":
	Passed: 13
	Failed: 0
Test "BACnet Device":
	Passed: 12
	Failed: 0
Test "BACnet I-Am":
	Passed: 6
	Fa</value>
                                        </BACnetTagPayloadOctetString>
                                      </payload>
                                    </BACnetApplicationTagOctetString>
                                  </BACnetApplicationTag>
                                </fileData>
                              </BACnetServiceAckAtomicReadFileStream>
                              <closingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetClosingTag>
                                  </BACnetClosingTag>
                                </BACnetContextTag>
                              </closingTag>
                            </BACnetServiceAckAtomicReadFileStreamOrRecord>
                          </accessMethod>
                        </BACnetServiceAckAtomicReadFile>
                      </BACnetServiceAck>
                    </serviceAck>
                    <segment dataType="byte" bitLength="0">0x</segment>
                  </APDUComplexAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>106	Confirmed-REQ   atomicReadFile[ 56] file,0 </name>
    <raw>810a001b010c000d013d02033806c4028000000e3203702201b80f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">27</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">true</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">56</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">6</serviceChoice>
                        <BACnetConfirmedServiceRequestAtomicReadFile>
                          <fileIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="FILE">10</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">0</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </fileIdentifier>
                          <accessMethod>
                            <BACnetConfirmedServiceRequestAtomicReadFileStreamOrRecord>
                              <openingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetOpeningTag>
                                  </BACnetOpeningTag>
                                </BACnetContextTag>
                              </openingTag>
                              <BACnetConfirmedServiceRequestAtomicReadFileStream>
                                <fileStartPosition>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagSignedInteger>
                                      <payload>
                                        <BACnetTagPayloadSignedInteger>
                                          <valueInt16 dataType="int" bitLength="16">880</valueInt16>
                                        </BACnetTagPayloadSignedInteger>
                                      </payload>
                                    </BACnetApplicationTagSignedInteger>
                                  </BACnetApplicationTag>
                                </fileStartPosition>
                                <requestOctetCount>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagUnsignedInteger>
                                      <payload>
                                        <BACnetTagPayloadUnsignedInteger>
                                          <valueUint16 dataType="uint" bitLength="16">440</valueUint16>
                                        </BACnetTagPayloadUnsignedInteger>
                                      </payload>
                                    </BACnetApplicationTagUnsignedInteger>
                                  </BACnetApplicationTag>
                                </requestOctetCount>
                              </BACnetConfirmedServiceRequestAtomicReadFileStream>
                              <closingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetClosingTag>
                                  </BACnetClosingTag>
                                </BACnetContextTag>
                              </closingTag>
                            </BACnetConfirmedServiceRequestAtomicReadFileStreamOrRecord>
                          </accessMethod>
                        </BACnetConfirmedServiceRequestAtomicReadFile>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>107	Complex-ACK     atomicReadFile[ 56] </name>
    <raw>810a01d00120000d013dff303806100e32037065fe01b8696c65643a20300a5465737420224241436e657420492d48617665223a0a095061737365643a20333436393331320a094661696c65643a20300a546573742022696e6465782074657874223a0a095061737365643a2032350a094661696c65643a20300a5465737420224241436e6574204c6966652053616665747920506f696e74223a0a095061737365643a20340a094661696c65643a20300a5465737420224241436e6574204d756c74692d7374617465204f7574707574223a0a095061737365643a20340a094661696c65643a20300a5465737420224241436e6574204e504455223a0a095061737365643a2032370a094661696c65643a20300a5465737420224241436e6574205265696e697469616c697a65446576696365223a0a095061737365643a20350a094661696c65643a20300a5465737420224241436e65742052656a656374223a0a095061737365643a203236303130370a094661696c65643a20300a54657374202272696e67627566223a0a095061737365643a203736390a094661696c65643a20300a5465737420224241436e6574205265616450726f7065727479223a0a095061737365643a2031370a090f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">464</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">3</apduType>
                  <APDUComplexAck>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">56</originalInvokeId>
                    <serviceAck>
                      <BACnetServiceAck>
                        <serviceChoice dataType="uint" bitLength="8">6</serviceChoice>
                        <BACnetServiceAckAtomicReadFile>
                          <endOfFile>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">0</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagBoolean>
                                <payload>
                                  <BACnetTagPayloadBoolean>
                                  </BACnetTagPayloadBoolean>
                                </payload>
                              </BACnetApplicationTagBoolean>
                            </BACnetApplicationTag>
                          </endOfFile>
                          <accessMethod>
                            <BACnetServiceAckAtomicReadFileStreamOrRecord>
                              <openingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetOpeningTag>
                                  </BACnetOpeningTag>
                                </BACnetContextTag>
                              </openingTag>
                              <BACnetServiceAckAtomicReadFileStream>
                                <fileStartPosition>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagSignedInteger>
                                      <payload>
                                        <BACnetTagPayloadSignedInteger>
                                          <valueInt16 dataType="int" bitLength="16">880</valueInt16>
                                        </BACnetTagPayloadSignedInteger>
                                      </payload>
                                    </BACnetApplicationTagSignedInteger>
                                  </BACnetApplicationTag>
                                </fileStartPosition>
                                <fileData>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">6</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                        <extLength dataType="uint" bitLength="8">254</extLength>
                                        <extExtLength dataType="uint" bitLength="16">440</extExtLength>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagOctetString>
                                      <payload>
                                        <BACnetTagPayloadOctetString>
                                          <value dataType="string" bitLength="3520" encoding="ASCII">iled: 0
Test "BACnet I-Have":
	Passed: 3469312
	Failed: 0
Test "index text":
	Passed: 25
	Failed: 0
Test "BACnet Life Safety Point":
	Passed: 4
	Failed: 0
Test "BACnet Multi-state Output":
	Passed: 4
	Failed: 0
Test "BACnet NPDU":
	Passed: 27
	Failed: 0
Test "BACnet ReinitializeDevice":
	Passed: 5
	Failed: 0
Test "BACnet Reject":
	Passed: 260107
	Failed: 0
Test "ringbuf":
	Passed: 769
	Failed: 0
Test "BACnet ReadProperty":
	Passed: 17</value>
                                        </BACnetTagPayloadOctetString>
                                      </payload>
                                    </BACnetApplicationTagOctetString>
                                  </BACnetApplicationTag>
                                </fileData>
                              </BACnetServiceAckAtomicReadFileStream>
                              <closingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetClosingTag>
                                  </BACnetClosingTag>
                                </BACnetContextTag>
                              </closingTag>
                            </BACnetServiceAckAtomicReadFileStreamOrRecord>
                          </accessMethod>
                        </BACnetServiceAckAtomicReadFile>
                      </BACnetServiceAck>
                    </serviceAck>
                    <segment dataType="byte" bitLength="0">0x</segment>
                  </APDUComplexAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>108	Confirmed-REQ   atomicReadFile[ 57] file,0 </name>
    <raw>810a001b010c000d013d02033906c4028000000e3205282201b80f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">27</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">true</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">57</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">6</serviceChoice>
                        <BACnetConfirmedServiceRequestAtomicReadFile>
                          <fileIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="FILE">10</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">0</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </fileIdentifier>
                          <accessMethod>
                            <BACnetConfirmedServiceRequestAtomicReadFileStreamOrRecord>
                              <openingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetOpeningTag>
                                  </BACnetOpeningTag>
                                </BACnetContextTag>
                              </openingTag>
                              <BACnetConfirmedServiceRequestAtomicReadFileStream>
                                <fileStartPosition>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagSignedInteger>
                                      <payload>
                                        <BACnetTagPayloadSignedInteger>
                                          <valueInt16 dataType="int" bitLength="16">1320</valueInt16>
                                        </BACnetTagPayloadSignedInteger>
                                      </payload>
                                    </BACnetApplicationTagSignedInteger>
                                  </BACnetApplicationTag>
                                </fileStartPosition>
                                <requestOctetCount>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">2</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagUnsignedInteger>
                                      <payload>
                                        <BACnetTagPayloadUnsignedInteger>
                                          <valueUint16 dataType="uint" bitLength="16">440</valueUint16>
                                        </BACnetTagPayloadUnsignedInteger>
                                      </payload>
                                    </BACnetApplicationTagUnsignedInteger>
                                  </BACnetApplicationTag>
                                </requestOctetCount>
                              </BACnetConfirmedServiceRequestAtomicReadFileStream>
                              <closingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetClosingTag>
                                  </BACnetClosingTag>
                                </BACnetContextTag>
                              </closingTag>
                            </BACnetConfirmedServiceRequestAtomicReadFileStreamOrRecord>
                          </accessMethod>
                        </BACnetConfirmedServiceRequestAtomicReadFile>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>109	Complex-ACK     atomicReadFile[ 57] </name>
    <raw>810a01200120000d013dff303906110e32052865fe01084661696c65643a20300a5465737420224241436e6574205265616450726f70657274794d756c7469706c65223a0a095061737365643a2037330a094661696c65643a20300a54657374202273746174696320627566666572223a0a095061737365643a2032320a094661696c65643a20300a5465737420224241436e65742057686f2d4973223a0a095061737365643a203130340a094661696c65643a20300a5465737420224241436e65742057686f2d486173223a0a095061737365643a20333934323535370a094661696c65643a20300a5465737420224241436e657420577269746550726f7065727479223a0a095061737365643a203138330a094661696c65643a20300a0f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">288</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">3</apduType>
                  <APDUComplexAck>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">57</originalInvokeId>
                    <serviceAck>
                      <BACnetServiceAck>
                        <serviceChoice dataType="uint" bitLength="8">6</serviceChoice>
                        <BACnetServiceAckAtomicReadFile>
                          <endOfFile>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagBoolean>
                                <payload>
                                  <BACnetTagPayloadBoolean>
                                  </BACnetTagPayloadBoolean>
                                </payload>
                              </BACnetApplicationTagBoolean>
                            </BACnetApplicationTag>
                          </endOfFile>
                          <accessMethod>
                            <BACnetServiceAckAtomicReadFileStreamOrRecord>
                              <openingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetOpeningTag>
                                  </BACnetOpeningTag>
                                </BACnetContextTag>
                              </openingTag>
                              <BACnetServiceAckAtomicReadFileStream>
                                <fileStartPosition>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">2</lengthValueType>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagSignedInteger>
                                      <payload>
                                        <BACnetTagPayloadSignedInteger>
                                          <valueInt16 dataType="int" bitLength="16">1320</valueInt16>
                                        </BACnetTagPayloadSignedInteger>
                                      </payload>
                                    </BACnetApplicationTagSignedInteger>
                                  </BACnetApplicationTag>
                                </fileStartPosition>
                                <fileData>
                                  <BACnetApplicationTag>
                                    <header>
                                      <BACnetTagHeader>
                                        <tagNumber dataType="uint" bitLength="4">6</tagNumber>
                                        <tagClass>
                                          <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                        </tagClass>
                                        <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                        <extLength dataType="uint" bitLength="8">254</extLength>
                                        <extExtLength dataType="uint" bitLength="16">264</extExtLength>
                                      </BACnetTagHeader>
                                    </header>
                                    <BACnetApplicationTagOctetString>
                                      <payload>
                                        <BACnetTagPayloadOctetString>
                                          <value dataType="string" bitLength="2112" encoding="ASCII">Failed: 0
Test "BACnet ReadPropertyMultiple":
	Passed: 73
	Failed: 0
Test "static buffer":
	Passed: 22
	Failed: 0
Test "BACnet Who-Is":
	Passed: 104
	Failed: 0
Test "BACnet Who-Has":
	Passed: 3942557
	Failed: 0
Test "BACnet WriteProperty":
	Passed: 183
	Failed: 0</value>
                                        </BACnetTagPayloadOctetString>
                                      </payload>
                                    </BACnetApplicationTagOctetString>
                                  </BACnetApplicationTag>
                                </fileData>
                              </BACnetServiceAckAtomicReadFileStream>
                              <closingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetClosingTag>
                                  </BACnetClosingTag>
                                </BACnetContextTag>
                              </closingTag>
                            </BACnetServiceAckAtomicReadFileStreamOrRecord>
                          </accessMethod>
                        </BACnetServiceAckAtomicReadFile>
                      </BACnetServiceAck>
                    </serviceAck>
                    <segment dataType="byte" bitLength="0">0x</segment>
                  </APDUComplexAck>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>110	Confirmed-REQ   atomicWriteFile[ 58] file,0 </name>
    <raw>810a01d3010c000d013d02033a07c4028000000e310065fe01b85465737420224241436e65742041626f7274223a0a095061737365643a203236303130370a094661696c65643a20300a5465737420224241436e65742041646472657373223a0a095061737365643a20323830350a094661696c65643a20300a5465737420224241436e657420446576696365436f6d6d756e69636174696f6e436f6e74726f6c223a0a095061737365643a2031320a094661696c65643a20300a5465737420224241436e657420416e616c6f6720496e707574223a0a095061737365643a20340a094661696c65643a20300a5465737420224241436e657420416e616c6f67204f7574707574223a0a095061737365643a20340a094661696c65643a20300a5465737420224241436e657420416e616c6f672056616c7565223a0a095061737365643a20340a094661696c65643a20300a5465737420224241436e65742041746f6d69635265616446696c65223a0a095061737365643a2032390a094661696c65643a20300a5465737420224241436e65742041746f6d6963577269746546696c65223a0a095061737365643a2032350a094661696c65643a20300a5465737420224241436e6574204170706c696361740f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">467</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">true</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">58</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">7</serviceChoice>
                        <BACnetConfirmedServiceRequestAtomicWriteFile>
                          <deviceIdentifier>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">12</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagObjectIdentifier>
                                <payload>
                                  <BACnetTagPayloadObjectIdentifier>
                                    <objectType dataType="uint" bitLength="10" stringRepresentation="FILE">10</objectType>
                                    <instanceNumber dataType="uint" bitLength="22">0</instanceNumber>
                                  </BACnetTagPayloadObjectIdentifier>
                                </payload>
                              </BACnetApplicationTagObjectIdentifier>
                            </BACnetApplicationTag>
                          </deviceIdentifier>
                          <openingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetOpeningTag>
                              </BACnetOpeningTag>
                            </BACnetContextTag>
                          </openingTag>
                          <fileStartPosition>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">3</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagSignedInteger>
                                <payload>
                                  <BACnetTagPayloadSignedInteger>
                                    <valueInt8 dataType="int" bitLength="8">0</valueInt8>
                                  </BACnetTagPayloadSignedInteger>
                                </payload>
                              </BACnetApplicationTagSignedInteger>
                            </BACnetApplicationTag>
                          </fileStartPosition>
                          <fileData>
                            <BACnetApplicationTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">6</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="APPLICATION_TAGS">0</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">5</lengthValueType>
                                  <extLength dataType="uint" bitLength="8">254</extLength>
                                  <extExtLength dataType="uint" bitLength="16">440</extExtLength>
                                </BACnetTagHeader>
                              </header>
                              <BACnetApplicationTagOctetString>
                                <payload>
                                  <BACnetTagPayloadOctetString>
                                    <value dataType="string" bitLength="3520" encoding="ASCII">Test "BACnet Abort":
	Passed: 260107
	Failed: 0
Test "BACnet Address":
	Passed: 2805
	Failed: 0
Test "BACnet DeviceCommunicationControl":
	Passed: 12
	Failed: 0
Test "BACnet Analog Input":
	Passed: 4
	Failed: 0
Test "BACnet Analog Output":
	Passed: 4
	Failed: 0
Test "BACnet Analog Value":
	Passed: 4
	Failed: 0
Test "BACnet AtomicReadFile":
	Passed: 29
	Failed: 0
Test "BACnet AtomicWriteFile":
	Passed: 25
	Failed: 0
Test "BACnet Applicat</value>
                                  </BACnetTagPayloadOctetString>
                                </payload>
                              </BACnetApplicationTagOctetString>
                            </BACnetApplicationTag>
                          </fileData>
                          <closingTag>
                            <BACnetContextTag>
                              <header>
                                <BACnetTagHeader>
                                  <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                  <tagClass>
                                    <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                  </tagClass>
                                  <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                </BACnetTagHeader>
                              </header>
                              <BACnetClosingTag>
                              </BACnetClosingTag>
                            </BACnetContextTag>
                          </closingTag>
                        </BACnetConfirmedServiceRequestAtomicWriteFile>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>111	Reject          unrecognized-service[ 58] </name>
    <raw>810a000e0120000d013dff603a09</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">14</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">6</apduType>
                  <APDUReject>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">58</originalInvokeId>
                    <rejectReason dataType="uint" bitLength="8">9</rejectReason>
                  </APDUReject>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>112	Confirmed-REQ   readPropertyMultiple[ 59] </name>
    <raw>810a0017010c000d013d02033b0e0c000000001e09081f</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">23</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">false</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">true</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">true</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationAddress isList="true">
              </destinationAddress>
              <sourceNetworkAddress dataType="uint" bitLength="16">13</sourceNetworkAddress>
              <sourceLength dataType="uint" bitLength="8">1</sourceLength>
              <sourceAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </sourceAddress>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">0</apduType>
                  <APDUConfirmedRequest>
                    <segmentedMessage dataType="bit" bitLength="1">false</segmentedMessage>
                    <moreFollows dataType="bit" bitLength="1">false</moreFollows>
                    <segmentedResponseAccepted dataType="bit" bitLength="1">true</segmentedResponseAccepted>
                    <reserved dataType="uint" bitLength="2">0</reserved>
                    <maxSegmentsAccepted dataType="uint" bitLength="3">0</maxSegmentsAccepted>
                    <maxApduLengthAccepted dataType="uint" bitLength="4">3</maxApduLengthAccepted>
                    <invokeId dataType="uint" bitLength="8">59</invokeId>
                    <serviceRequest>
                      <BACnetConfirmedServiceRequest>
                        <serviceChoice dataType="uint" bitLength="8">14</serviceChoice>
                        <BACnetConfirmedServiceRequestReadPropertyMultiple>
                          <data isList="true">
                            <BACnetReadAccessSpecification>
                              <objectIdentifier>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">4</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetContextTagObjectIdentifier>
                                    <payload>
                                      <BACnetTagPayloadObjectIdentifier>
                                        <objectType dataType="uint" bitLength="10" stringRepresentation="ANALOG_INPUT">0</objectType>
                                        <instanceNumber dataType="uint" bitLength="22">0</instanceNumber>
                                      </BACnetTagPayloadObjectIdentifier>
                                    </payload>
                                  </BACnetContextTagObjectIdentifier>
                                </BACnetContextTag>
                              </objectIdentifier>
                              <openingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">6</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetOpeningTag>
                                  </BACnetOpeningTag>
                                </BACnetContextTag>
                              </openingTag>
                              <listOfPropertyReferences isList="true">
                                <BACnetPropertyReference>
                                  <propertyIdentifier>
                                    <BACnetContextTag>
                                      <header>
                                        <BACnetTagHeader>
                                          <tagNumber dataType="uint" bitLength="4">0</tagNumber>
                                          <tagClass>
                                            <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                          </tagClass>
                                          <lengthValueType dataType="uint" bitLength="3">1</lengthValueType>
                                        </BACnetTagHeader>
                                      </header>
                                      <BACnetContextTagPropertyIdentifier>
                                        <propertyIdentifier dataType="uint" bitLength="8" stringRepresentation="ALL">8</propertyIdentifier>
                                      </BACnetContextTagPropertyIdentifier>
                                    </BACnetContextTag>
                                  </propertyIdentifier>
                                </BACnetPropertyReference>
                              </listOfPropertyReferences>
                              <closingTag>
                                <BACnetContextTag>
                                  <header>
                                    <BACnetTagHeader>
                                      <tagNumber dataType="uint" bitLength="4">1</tagNumber>
                                      <tagClass>
                                        <TagClass dataType="uint" bitLength="1" stringRepresentation="CONTEXT_SPECIFIC_TAGS">1</TagClass>
                                      </tagClass>
                                      <lengthValueType dataType="uint" bitLength="3">7</lengthValueType>
                                    </BACnetTagHeader>
                                  </header>
                                  <BACnetClosingTag>
                                  </BACnetClosingTag>
                                </BACnetContextTag>
                              </closingTag>
                            </BACnetReadAccessSpecification>
                          </data>
                        </BACnetConfirmedServiceRequestReadPropertyMultiple>
                      </BACnetConfirmedServiceRequest>
                    </serviceRequest>
                  </APDUConfirmedRequest>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

  <testcase>
    <name>113	Reject          unrecognized-service[ 59] </name>
    <raw>810a000e0120000d013dff603b09</raw>
    <root-type>BVLC</root-type>
    <xml>
      <BVLC>
        <bacnetType dataType="uint" bitLength="8">129</bacnetType>
        <bvlcFunction dataType="uint" bitLength="8">10</bvlcFunction>
        <bvlcLength dataType="uint" bitLength="16">14</bvlcLength>
        <BVLCOriginalUnicastNPDU>
          <npdu>
            <NPDU>
              <protocolVersionNumber dataType="uint" bitLength="8">1</protocolVersionNumber>
              <control>
                <NPDUControl>
                  <messageTypeFieldPresent dataType="bit" bitLength="1">false</messageTypeFieldPresent>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <destinationSpecified dataType="bit" bitLength="1">true</destinationSpecified>
                  <reserved dataType="uint" bitLength="1">0</reserved>
                  <sourceSpecified dataType="bit" bitLength="1">false</sourceSpecified>
                  <expectingReply dataType="bit" bitLength="1">false</expectingReply>
                  <networkPriority>
                    <NPDUNetworkPriority dataType="uint" bitLength="2" stringRepresentation="NORMAL_MESSAGE">0</NPDUNetworkPriority>
                  </networkPriority>
                </NPDUControl>
              </control>
              <destinationNetworkAddress dataType="uint" bitLength="16">13</destinationNetworkAddress>
              <destinationLength dataType="uint" bitLength="8">1</destinationLength>
              <destinationAddress isList="true">
                <value dataType="uint" bitLength="8">61</value>
              </destinationAddress>
              <sourceAddress isList="true">
              </sourceAddress>
              <hopCount dataType="uint" bitLength="8">255</hopCount>
              <apdu>
                <APDU>
                  <apduType dataType="uint" bitLength="4">6</apduType>
                  <APDUReject>
                    <reserved dataType="uint" bitLength="4">0</reserved>
                    <originalInvokeId dataType="uint" bitLength="8">59</originalInvokeId>
                    <rejectReason dataType="uint" bitLength="8">9</rejectReason>
                  </APDUReject>
                </APDU>
              </apdu>
            </NPDU>
          </npdu>
        </BVLCOriginalUnicastNPDU>
      </BVLC>
    </xml>
  </testcase>

</test:testsuite>